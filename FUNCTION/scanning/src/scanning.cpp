//
// File: scanning.cpp
//
// Code generated for Simulink model 'scanning'.
//
// Model version                  : 1.230
// Simulink Coder version         : 8.6 (R2014a) 27-Dec-2013
// C/C++ source code generated on : Fri Jun 30 13:51:12 2017
//
// Target selection: ert.tlc
// Embedded hardware selection: 32-bit Generic
// Code generation objectives: Unspecified
// Validation result: Not run
//
#include "scanning.h"
#include "scanning_private.h"

// Function for MATLAB Function: '<Root>/MATLAB Function'
real_T scanningModelClass::scanning_GetAngle(real_T x, real_T y)
{
  real_T angle;
  if ((x == 0.0) && (y > 0.0)) {
    angle = 1.5707963267948966;
  } else if ((x == 0.0) && (y < 0.0)) {
    angle = 4.71238898038469;
  } else if ((y == 0.0) && (x > 0.0)) {
    angle = 0.0;
  } else if ((y == 0.0) && (x < 0.0)) {
    angle = 3.1415926535897931;
  } else if ((x > 0.0) && (y > 0.0)) {
    angle = std::atan(y / x);
  } else if ((x > 0.0) && (y < 0.0)) {
    angle = std::atan(y / x) + 6.2831853071795862;
  } else if ((x < 0.0) && (y > 0.0)) {
    angle = std::atan(y / x) + 3.1415926535897931;
  } else if ((x < 0.0) && (y < 0.0)) {
    angle = std::atan(y / x) + 3.1415926535897931;
  } else {
    angle = 0.0;
  }

  return angle;
}

real_T rt_roundd_snf(real_T u)
{
  real_T y;
  if (std::abs(u) < 4.503599627370496E+15) {
    if (u >= 0.5) {
      y = std::floor(u + 0.5);
    } else if (u > -0.5) {
      y = u * 0.0;
    } else {
      y = std::ceil(u - 0.5);
    }
  } else {
    y = u;
  }

  return y;
}

// Function for MATLAB Function: '<Root>/MATLAB Function'
real_T scanningModelClass::scanning_AngleDiff(real_T angle1, real_T angle2)
{
  real_T d;
  real_T r;
  if (std::abs(angle2 - angle1) <= 3.1415926535897931) {
    d = angle2 - angle1;
  } else {
    r = (angle2 - angle1) / 6.2831853071795862;
    if (std::abs(r - rt_roundd_snf(r)) <= 2.2204460492503131E-16 * std::abs(r))
    {
      r = 0.0;
    } else {
      r = (r - std::floor(r)) * 6.2831853071795862;
    }

    if (r <= 3.1415926535897931) {
      d = (angle2 - angle1) / 6.2831853071795862;
      if (std::abs(d - rt_roundd_snf(d)) <= 2.2204460492503131E-16 * std::abs(d))
      {
        d = 0.0;
      } else {
        d = (d - std::floor(d)) * 6.2831853071795862;
      }
    } else {
      r = (angle2 - angle1) / 6.2831853071795862;
      if (std::abs(r - rt_roundd_snf(r)) <= 2.2204460492503131E-16 * std::abs(r))
      {
        r = 0.0;
      } else {
        r = (r - std::floor(r)) * 6.2831853071795862;
      }

      d = r - 6.2831853071795862;
    }
  }

  return d;
}

// Function for MATLAB Function: '<Root>/MATLAB Function3'
real_T scanningModelClass::scanning_GetAngle_n(real_T x, real_T y)
{
  real_T angle;
  if ((x == 0.0) && (y > 0.0)) {
    angle = 1.5707963267948966;
  } else if ((x == 0.0) && (y < 0.0)) {
    angle = 4.71238898038469;
  } else if ((y == 0.0) && (x > 0.0)) {
    angle = 0.0;
  } else if ((y == 0.0) && (x < 0.0)) {
    angle = 3.1415926535897931;
  } else if ((x > 0.0) && (y > 0.0)) {
    angle = std::atan(y / x);
  } else if ((x > 0.0) && (y < 0.0)) {
    angle = std::atan(y / x) + 6.2831853071795862;
  } else if ((x < 0.0) && (y > 0.0)) {
    angle = std::atan(y / x) + 3.1415926535897931;
  } else if ((x < 0.0) && (y < 0.0)) {
    angle = std::atan(y / x) + 3.1415926535897931;
  } else {
    angle = 0.0;
  }

  return angle;
}

// Function for MATLAB Function: '<Root>/MATLAB Function3'
real_T scanningModelClass::scanning_AngleDiff_b(real_T angle1, real_T angle2)
{
  real_T d;
  real_T r;
  if (std::abs(angle2 - angle1) <= 3.1415926535897931) {
    d = angle2 - angle1;
  } else {
    r = (angle2 - angle1) / 6.2831853071795862;
    if (std::abs(r - rt_roundd_snf(r)) <= 2.2204460492503131E-16 * std::abs(r))
    {
      r = 0.0;
    } else {
      r = (r - std::floor(r)) * 6.2831853071795862;
    }

    if (r <= 3.1415926535897931) {
      d = (angle2 - angle1) / 6.2831853071795862;
      if (std::abs(d - rt_roundd_snf(d)) <= 2.2204460492503131E-16 * std::abs(d))
      {
        d = 0.0;
      } else {
        d = (d - std::floor(d)) * 6.2831853071795862;
      }
    } else {
      r = (angle2 - angle1) / 6.2831853071795862;
      if (std::abs(r - rt_roundd_snf(r)) <= 2.2204460492503131E-16 * std::abs(r))
      {
        r = 0.0;
      } else {
        r = (r - std::floor(r)) * 6.2831853071795862;
      }

      d = r - 6.2831853071795862;
    }
  }

  return d;
}

// Function for MATLAB Function: '<Root>/MATLAB Function1'
real_T scanningModelClass::scanning_AngleDiff_f(real_T angle1, real_T angle2)
{
  real_T d;
  real_T r;
  if (std::abs(angle2 - angle1) <= 3.1415926535897931) {
    d = angle2 - angle1;
  } else {
    r = (angle2 - angle1) / 6.2831853071795862;
    if (std::abs(r - rt_roundd_snf(r)) <= 2.2204460492503131E-16 * std::abs(r))
    {
      r = 0.0;
    } else {
      r = (r - std::floor(r)) * 6.2831853071795862;
    }

    if (r <= 3.1415926535897931) {
      d = (angle2 - angle1) / 6.2831853071795862;
      if (std::abs(d - rt_roundd_snf(d)) <= 2.2204460492503131E-16 * std::abs(d))
      {
        d = 0.0;
      } else {
        d = (d - std::floor(d)) * 6.2831853071795862;
      }
    } else {
      r = (angle2 - angle1) / 6.2831853071795862;
      if (std::abs(r - rt_roundd_snf(r)) <= 2.2204460492503131E-16 * std::abs(r))
      {
        r = 0.0;
      } else {
        r = (r - std::floor(r)) * 6.2831853071795862;
      }

      d = r - 6.2831853071795862;
    }
  }

  return d;
}

// Function for MATLAB Function: '<Root>/MATLAB Function2'
real_T scanningModelClass::scanning_AngleDiff_p(real_T angle1, real_T angle2)
{
  real_T d;
  real_T r;
  if (std::abs(angle2 - angle1) <= 3.1415926535897931) {
    d = angle2 - angle1;
  } else {
    r = (angle2 - angle1) / 6.2831853071795862;
    if (std::abs(r - rt_roundd_snf(r)) <= 2.2204460492503131E-16 * std::abs(r))
    {
      r = 0.0;
    } else {
      r = (r - std::floor(r)) * 6.2831853071795862;
    }

    if (r <= 3.1415926535897931) {
      d = (angle2 - angle1) / 6.2831853071795862;
      if (std::abs(d - rt_roundd_snf(d)) <= 2.2204460492503131E-16 * std::abs(d))
      {
        d = 0.0;
      } else {
        d = (d - std::floor(d)) * 6.2831853071795862;
      }
    } else {
      r = (angle2 - angle1) / 6.2831853071795862;
      if (std::abs(r - rt_roundd_snf(r)) <= 2.2204460492503131E-16 * std::abs(r))
      {
        r = 0.0;
      } else {
        r = (r - std::floor(r)) * 6.2831853071795862;
      }

      d = r - 6.2831853071795862;
    }
  }

  return d;
}

// Function for MATLAB Function: '<Root>/MATLAB Function1'
real_T scanningModelClass::scanning_SailDeadZone(real_T sail_check, const real_T
  dead_sail_data[], const int32_T dead_sail_sizes[2])
{
  real_T check;
  int32_T i;
  check = 0.0;
  for (i = 0; i < dead_sail_sizes[0]; i++) {
    while (sail_check < dead_sail_data[i]) {
      sail_check += 360.0;
    }

    if (sail_check < dead_sail_data[i + dead_sail_sizes[0]]) {
      check = 1.0;
    }
  }

  return check;
}

// Function for MATLAB Function: '<Root>/MATLAB Function1'
real_T scanningModelClass::scanning_ppval(const real_T pp_breaks[59], const
  real_T pp_coefs[232], real_T x)
{
  real_T v;
  real_T xloc;
  int32_T low_i;
  int32_T low_ip1;
  int32_T high_i;
  int32_T mid_i;
  if (rtIsNaN(x)) {
    v = x;
  } else {
    low_i = 0;
    low_ip1 = 2;
    high_i = 59;
    while (high_i > low_ip1) {
      mid_i = ((low_i + high_i) + 1) >> 1;
      if (x >= pp_breaks[mid_i - 1]) {
        low_i = mid_i - 1;
        low_ip1 = mid_i + 1;
      } else {
        high_i = mid_i;
      }
    }

    xloc = x - pp_breaks[low_i];
    v = ((xloc * pp_coefs[low_i] + pp_coefs[low_i + 58]) * xloc + pp_coefs[low_i
         + 116]) * xloc + pp_coefs[low_i + 174];
  }

  return v;
}

// Function for MATLAB Function: '<Root>/MATLAB Function1'
real_T scanningModelClass::scanning_interp1(real_T varargin_3)
{
  real_T Vq;
  static real_T b_breaks[59] = { 0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0,
    9.0, 10.0, 11.0, 12.0, 13.0, 14.0, 15.0, 16.0, 17.0, 18.0, 19.0, 20.0, 21.0,
    22.0, 23.0, 24.0, 25.0, 26.0, 27.0, 30.0, 35.0, 40.0, 45.0, 50.0, 55.0, 60.0,
    65.0, 70.0, 75.0, 80.0, 85.0, 90.0, 95.0, 100.0, 105.0, 110.0, 115.0, 120.0,
    125.0, 130.0, 135.0, 140.0, 145.0, 150.0, 155.0, 160.0, 165.0, 170.0, 175.0,
    180.0 };

  static real_T b_coefs[232] = { -0.0016369930069929997, -0.020155721529329765,
    -6.8728522336770079E-5, 0.0073662522202486667, 0.0043461347459461779,
    0.047905909922957776, 0.06452602739726028, -0.00067430340557275443,
    -0.018345587676857029, -0.0046658469190384161, -4.4078255934984489E-5,
    -0.001030859640277125, -0.00068830728161273225, -0.00011169809800128105,
    -0.00030548251203626337, -0.00015079417517928351, -9.29368832794375E-8,
    -9.2764458212157841E-8, -5.0046339203045631E-5, 2.0816681711721685E-17,
    2.0816681711721685E-17, -8.3266726846886741E-17, 1.2490009027033011E-16,
    -9.71445146547012E-17, 1.2490009027033011E-16, -0.00025116279069774955,
    -0.030374058413593249, 0.0015394452041313407, -0.00072652178460524844,
    -8.1066454436926321E-5, -5.1428571428572235E-5, 0.00015157894736842118,
    0.0001377858439201457, -4.8664898320071169E-5, 0.00010880167451596048,
    6.3673469387755252E-5, -1.962264150943402E-5, 2.0377358490566156E-5,
    -1.9636363636363896E-5, 2.0363636363636555E-5, 2.0363636363636416E-5,
    -1.9636363636363618E-5, 2.0377358490566017E-5, 7.6951535331146069E-7,
    0.00011675579322638062, -8.3095823095822026E-5, -1.9459459459459788E-5,
    4.2352941176470178E-5, 0.00011004524886877947, 0.00030769230769230689,
    -0.00048761904761904733, -0.00038327122153209158, -0.00028083735909822824,
    -0.00014518518518518542, 0.00015069767441860498, 0.0021506976744186035,
    -0.00067952941176470578, -0.0010395294117647069, -0.0060130069930070112,
    0.014142714536322768, -0.00086254295532646073, -0.021766252220248663,
    -0.024812386966194852, -0.084185792448655275, -0.055452054794520561,
    0.0039743034055727518, 0.041419891082429786, 0.011237131190322693,
    0.0021386409036891277, 0.0032803752484579576, 0.0019696513137090269,
    0.00071866134751771837, 0.00081021736052112187, 0.00035154183873067207,
    5.013944851119112E-5, 5.0139189713513388E-5, 0.00010009267840605657,
    -4.163336342344337E-17, -2.0816681711721685E-17, 1.1796119636642288E-16,
    -1.8735013540549517E-16, 1.457167719820518E-16, -1.8735013540549517E-16,
    0.00025116279069779812, 0.030125221204290894, -0.0080107037380954815,
    0.0053370284310107008, -0.0004464783127735854, -8.5714285714282609E-5,
    -0.0019578947368421068, -0.0016468239564428346, -8.7709991158262828E-5,
    -0.0013696493982208291, -0.00063673469387755255, 9.81132075471701E-5,
    -0.00020377358490566088, 9.8181818181820174E-5, -0.00020363636363636555,
    -0.00010181818181818209, 0.00019636363636363617, -0.00010188679245283009,
    9.42656307806128E-5, -0.00048573975044562752, 0.0009336609336609257,
    0.00019459459459459787, -0.00021176470588235089, -0.00036199095022625204,
    -0.0010769230769230717, 0.0056380952380952355, 0.0031544513457556975,
    0.00088244766505635869, 5.1851851851853056E-5, -0.0025534883720930266,
    -0.014706976744186036, 0.010997647058823527, 0.019795294117647064,
    0.051050000000000012, 0.03411300699300699, 0.0019312714776632317, 0.0,
    -0.021433747779751326, -0.058020117474302496, -0.082673972602739718, 0.0,
    0.00592569659442724, 0.033728715728715726, 0.042205437352245863,
    0.046350484391819165, 0.049818655967903705, 0.051693036750483562,
    0.052795265151515156, 0.053499252336448609, 0.0537499534883721,
    0.053849953574744647, 0.053949953660797037, 0.054000000000000013,
    0.053999999999999992, 0.054000000000000013, 0.054, 0.054, 0.054, 0.054,
    0.053748837209302347, 0.022877104377104388, 0.016377902460077694,
    0.015259052924791072, 0.0047142857142857438, 0.0, -0.00821052631578948,
    -0.0143448275862069, -0.018871794871794866, -0.024408163265306121,
    -0.026000000000000002, -0.026490566037735853, -0.027, -0.02749090909090909,
    -0.028000000000000004, -0.027490909090909094, -0.027000000000000003,
    -0.026490566037735853, -0.025490196078431365, -0.021590909090909095,
    -0.01848648648648649, -0.017999999999999995, -0.016941176470588241,
    -0.0123076923076923, 0.0, 0.019809523809523805, 0.02260869565217391,
    0.010370370370370377, 0.0, -0.014232558139534892, 0.0, 0.05901176470588234,
    0.0, 0.0434, 0.0715, 0.0725, 0.0581, 0.0162, -0.0781, -0.1517, -0.1484,
    -0.1194, -0.0791, -0.0348, 0.0138, 0.0649, 0.1172, 0.1705, 0.2242, 0.278,
    0.3319, 0.3859, 0.4399, 0.4939, 0.5479, 0.6019, 0.6559, 0.7099, 0.7639,
    0.8174, 0.8555, 0.98, 1.035, 1.05, 1.02, 0.955, 0.875, 0.76, 0.63, 0.5,
    0.365, 0.23, 0.09, -0.05, -0.185, -0.32, -0.45, -0.575, -0.67, -0.76, -0.85,
    -0.93, -0.98, -0.9, -0.77, -0.67, -0.635, -0.68, -0.85, -0.66 };

  if (rtIsNaN(varargin_3)) {
    Vq = (rtNaN);
  } else {
    Vq = scanning_ppval(b_breaks, b_coefs, varargin_3);
  }

  return Vq;
}

// Function for MATLAB Function: '<Root>/MATLAB Function1'
real_T scanningModelClass::scanning_interp1_n(real_T varargin_3)
{
  real_T Vq;
  static real_T b_breaks[59] = { 0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0,
    9.0, 10.0, 11.0, 12.0, 13.0, 14.0, 15.0, 16.0, 17.0, 18.0, 19.0, 20.0, 21.0,
    22.0, 23.0, 24.0, 25.0, 26.0, 27.0, 30.0, 35.0, 40.0, 45.0, 50.0, 55.0, 60.0,
    65.0, 70.0, 75.0, 80.0, 85.0, 90.0, 95.0, 100.0, 105.0, 110.0, 115.0, 120.0,
    125.0, 130.0, 135.0, 140.0, 145.0, 150.0, 155.0, 160.0, 165.0, 170.0, 175.0,
    180.0 };

  static real_T b_coefs[232] = { -3.3333333333330421E-5, -2.424242424241697E-5,
    -6.7379679144385809E-5, -0.00017647058823529519, -0.00017647058823529519,
    0.00073976872800402221, -0.0087670940170940116, -0.0010833333333333424,
    0.00048148148148148551, 0.00041481481481481404, -0.0010666666666666689,
    0.00048484848484849075, -2.9437229437250662E-5, -2.7799227799212012E-5,
    -0.00051351351351349925, 0.00094999999999997517, -0.001049999999999985,
    0.00048837209302327045, -0.000511627906976786, 0.00048888888888894491,
    -2.1749408983480489E-5, -2.0842379505021241E-5, -0.00051020408163259673,
    0.000490196078431343, -1.9237883832807362E-5, -1.8524871355004441E-5,
    0.0025497326203208111, -0.00071011273981005051, 3.5339805825242154E-5,
    -8.4848484848485387E-5, 1.2100667693889513E-5, 1.5467671060889612E-5,
    1.8126361655774747E-5, -6.7348678601876074E-5, 8.4280936454854477E-6,
    -3.4615384615385018E-5, -5.1739130434783336E-5, -6.0200668896320189E-5,
    -9.8461538461538722E-5, 0.0, 0.00012800000000000008, -1.2000000000000026E-5,
    4.78260869565221E-5, 1.4032983508244982E-5, 2.8559837728196134E-5,
    -4.5451936872311361E-5, 7.3861788617886763E-5, -1.4937106918239405E-5,
    -1.1270440251571198E-5, 4.6545454545453139E-5, 2.3549783549786618E-6,
    0.00014860554371002173, 0.00017491366695932068, -0.00013044375644994833,
    -3.7894736842105235E-5, 2.0571428571428407E-5, 0.00030578881987577657,
    0.00010521739130434787, 0.00013333333333332635, 0.00015757575757574332,
    0.00025828877005347809, 0.00035294117647059037, 0.00017647058823529519,
    -0.00086329813976872868, 0.018450854700854693, 0.0021666666666666813,
    -0.000481481481481489, 0.00010370370370370481, 0.0021333333333333378,
    -0.00048484848484849075, 0.00054458874458877468, 0.00054208494208491179,
    0.0010270270270270124, -0.00094999999999996129, 0.00209999999999997,
    -0.00048837209302327045, 0.0010232558139535441, -0.00048888888888897267,
    0.00053286052009461973, 0.00053148067737736338, 0.0010204081632652212,
    -0.0004901960784313153, 0.00052904180540143744, 0.0005279588336191271,
    -0.0020406417112298729, 0.0039996192651817752, -0.00035339805825242154,
    0.00042424242424242696, -0.00043626091422702617, -0.00036208411801630852,
    -0.00028322440087147073, 0.0002387041773231083, -0.00040735785953177552,
    -0.00010384615384615022, -9.1304347826083642E-5, -9.0301003344487435E-5,
    0.00018461538461538648, 0.0, -0.0014400000000000012, -0.00017999999999999998,
    -0.00073913043478261091, -0.000409295352323831, -0.00047383367139960453,
    1.5494978479208693E-5, -0.00093028455284553473, -0.00013364779874213626,
    -0.0002606289308176184, -0.00065939393939392775, -0.00021783549783550152,
    -0.0009487420042643941, -0.00041188176763242291, 0.0015149638802889568,
    0.00037894736842105232, -0.00010285714285714203, -0.0014318012422360263,
    4.7826086956521789E-5, 0.0001000000000000098, 0.00026666666666667123,
    0.000509090909090907, 0.0008235294117647057, 0.0010000000000000009,
    0.0008235294117647057, 0.001316239316239315, 0.011916666666666666,
    0.013000000000000001, 0.01348148148148148, 0.014933333333333331, 0.016,
    0.016484848484848491, 0.017485714285714288, 0.018486486486486476,
    0.019000000000000003, 0.019950000000000006, 0.020999999999999991,
    0.021488372093023261, 0.021999999999999992, 0.022488888888888881,
    0.023489361702127679, 0.024489795918367342, 0.024999999999999994,
    0.025490196078431393, 0.026490566037735846, 0.027490909090909087,
    0.031058823529411774, 0.035883495145631064, 0.03500000000000001,
    0.032878787878787875, 0.029423728813559327, 0.026962962962962963,
    0.025490196078431362, 0.022826086956521739, 0.019384615384615392,
    0.015750000000000014, 0.010956521739130427, 0.005538461538461539, 0.0, 0.0,
    -0.0048000000000000048, -0.0075000000000000067, -0.011304347826086959,
    -0.014344827586206895, -0.01694117647058823, -0.020195121951219495,
    -0.023958333333333335, -0.026415094339622653, -0.029866666666666677,
    -0.032969696969696968, -0.034971428571428584, -0.033313432835820896,
    -0.024313725490196073, -0.018947368421052629, -0.018, -0.017485714285714288,
    -0.0088695652173913057, 0.036, 0.0362, 0.0366, 0.0373, 0.0383, 0.0393, 0.04,
    0.051, 0.064, 0.077, 0.091, 0.107, 0.123, 0.14, 0.158, 0.177, 0.196, 0.217,
    0.238, 0.26, 0.282, 0.305, 0.329, 0.354, 0.379, 0.405, 0.432, 0.46, 0.57,
    0.745, 0.92, 1.075, 1.215, 1.345, 1.47, 1.575, 1.665, 1.735, 1.78, 1.8, 1.8,
    1.78, 1.75, 1.7, 1.635, 1.555, 1.465, 1.35, 1.225, 1.085, 0.925, 0.755,
    0.575, 0.42, 0.32, 0.23, 0.14, 0.055 };

  if (rtIsNaN(varargin_3)) {
    Vq = (rtNaN);
  } else {
    Vq = scanning_ppval(b_breaks, b_coefs, varargin_3);
  }

  return Vq;
}

// Function for MATLAB Function: '<Root>/MATLAB Function1'
real_T scanningModelClass::scanning_interp1_nz(real_T varargin_3)
{
  real_T Vq;
  static real_T b_breaks[59] = { 0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0,
    9.0, 10.0, 11.0, 12.0, 13.0, 14.0, 15.0, 16.0, 17.0, 18.0, 19.0, 20.0, 21.0,
    22.0, 23.0, 24.0, 25.0, 26.0, 27.0, 30.0, 35.0, 40.0, 45.0, 50.0, 55.0, 60.0,
    65.0, 70.0, 75.0, 80.0, 85.0, 90.0, 95.0, 100.0, 105.0, 110.0, 115.0, 120.0,
    125.0, 130.0, 135.0, 140.0, 145.0, 150.0, 155.0, 160.0, 165.0, 170.0, 175.0,
    180.0 };

  static real_T b_coefs[232] = { -5.0689655172422854E-5, -0.0054018747929046179,
    -0.00048262249361233356, -0.012030004059297925, -0.022298566703417858,
    0.0091906776622445313, 0.22552056803983281, 0.13652989037758831,
    -0.0015510638297872338, -0.018400130496453882, -0.0039114418054014138,
    -0.00081472687697604212, -0.001157253699025633, 0.00013699640930196766,
    -0.00031040642765595844, -0.00030235148308303122, 9.9534710008029881E-5,
    -0.00020046502990649084, 0.00014976804598768739, -0.00010018552875694364,
    2.0816681711721685E-17, -8.3266726846886741E-17, 1.2490009027033011E-16,
    -9.71445146547012E-17, 1.2490009027033011E-16, 9.9815157116392439E-5,
    -0.032361483348943919, 0.00152546040207433, -0.00075993787056638507,
    -8.03174603174586E-5, -5.1428571428572235E-5, 0.00015157894736842118,
    0.0001377858439201457, -4.8664898320071169E-5, 0.00010880167451596048,
    6.3673469387755252E-5, -1.962264150943402E-5, 2.0377358490566156E-5,
    -1.9636363636363896E-5, 2.0363636363636555E-5, 2.0363636363636416E-5,
    -1.9636363636363618E-5, 2.0377358490566017E-5, 7.6951535331146069E-7,
    0.00011675579322638062, -8.3095823095822026E-5, -1.9459459459459788E-5,
    4.2352941176470178E-5, 0.00011004524886877947, 0.00030769230769230689,
    -0.00048761904761904733, -0.00038327122153209158, -0.00028083735909822824,
    -0.00014518518518518542, 0.00015069767441860498, 0.0021506976744186035,
    -0.00067952941176470578, -0.0010395294117647069, -0.0020493103448275818,
    0.0033525644480770361, -0.0057661923686554428, 0.0064614414151780014,
    0.01279713340683572, -0.04499067766224453, -0.40621124570207734,
    -0.10565978075517662, 0.0069510638297872358, 0.041351194326241104,
    0.0099605084720680859, 0.0031771020157107741, 0.0028096054372669516,
    0.0003679055514823476, 0.00096850805756967112, 0.00065465628082526928,
    -4.9488024667219965E-5, 0.00035088363455764576, -0.00019972162073234045,
    0.00020037105751388729, -2.0816681711721685E-17, 1.1796119636642288E-16,
    -1.8735013540549517E-16, 1.457167719820518E-16, -1.8735013540549517E-16,
    -9.9815157116343867E-5, 0.032461668191827456, -0.00790039281531399,
    0.0056549342612194032, -0.00045396825396826256, -8.5714285714282609E-5,
    -0.0019578947368421068, -0.0016468239564428346, -8.7709991158262828E-5,
    -0.0013696493982208291, -0.00063673469387755255, 9.81132075471701E-5,
    -0.00020377358490566088, 9.8181818181820174E-5, -0.00020363636363636555,
    -0.00010181818181818209, 0.00019636363636363617, -0.00010188679245283009,
    9.42656307806128E-5, -0.00048573975044562752, 0.0009336609336609257,
    0.00019459459459459787, -0.00021176470588235089, -0.00036199095022625204,
    -0.0010769230769230717, 0.0056380952380952355, 0.0031544513457556975,
    0.00088244766505635869, 5.1851851851853056E-5, -0.0025534883720930266,
    -0.014706976744186036, 0.010997647058823527, 0.019795294117647064, 0.0912,
    0.086949310344827571, 0.07744881486226779, 0.0644685626441199,
    0.041301433296582132, 0.0, -0.062409322337755466, -0.19827010962241168, 0.0,
    0.00924893617021277, 0.036750933333333333, 0.044937624861265263,
    0.048847648261758685, 0.050995098039215689, 0.052141898370086287,
    0.053147695202257754, 0.0535499533146592, 0.053749581395348849,
    0.053849953574744668, 0.053899814471243049, 0.053999999999999992,
    0.054000000000000013, 0.054, 0.054, 0.054, 0.054, 0.054099815157116489,
    0.021938701493939648, 0.015723775458062611, 0.015277777777777765,
    0.0047142857142857438, 0.0, -0.00821052631578948, -0.0143448275862069,
    -0.018871794871794866, -0.024408163265306121, -0.026000000000000002,
    -0.026490566037735853, -0.027, -0.02749090909090909, -0.028000000000000004,
    -0.027490909090909094, -0.027000000000000003, -0.026490566037735853,
    -0.025490196078431365, -0.021590909090909095, -0.01848648648648649,
    -0.017999999999999995, -0.016941176470588241, -0.0123076923076923, 0.0,
    0.019809523809523805, 0.02260869565217391, 0.010370370370370377, 0.0,
    -0.014232558139534892, 0.0, 0.05901176470588234, 0.0, 0.0891, 0.174, 0.2452,
    0.3041, 0.3359, 0.3001, 0.057, -0.1104, -0.105, -0.0728, -0.03, 0.0173,
    0.0678, 0.1193, 0.1721, 0.2256, 0.2792, 0.3331, 0.3869, 0.4409, 0.4949,
    0.5489, 0.6029, 0.6569, 0.7109, 0.7649, 0.8191, 0.855, 0.98, 1.035, 1.05,
    1.02, 0.955, 0.875, 0.76, 0.63, 0.5, 0.365, 0.23, 0.09, -0.05, -0.185, -0.32,
    -0.45, -0.575, -0.67, -0.76, -0.85, -0.93, -0.98, -0.9, -0.77, -0.67, -0.635,
    -0.68, -0.85, -0.66 };

  if (rtIsNaN(varargin_3)) {
    Vq = (rtNaN);
  } else {
    Vq = scanning_ppval(b_breaks, b_coefs, varargin_3);
  }

  return Vq;
}

// Function for MATLAB Function: '<Root>/MATLAB Function1'
real_T scanningModelClass::scanning_interiorSlope(real_T d1, real_T d2, real_T
  w1, real_T w2)
{
  real_T s;
  s = 0.0;
  if (d1 < 0.0) {
    if (d2 <= d1) {
      s = d1 / (d1 / d2 * w1 + w2);
    } else {
      if (d2 < 0.0) {
        s = d2 / (d2 / d1 * w2 + w1);
      }
    }
  } else {
    if (d1 > 0.0) {
      if (d2 >= d1) {
        s = d1 / (d1 / d2 * w1 + w2);
      } else {
        if (d2 > 0.0) {
          s = d2 / (d2 / d1 * w2 + w1);
        }
      }
    }
  }

  return s;
}

// Function for MATLAB Function: '<Root>/MATLAB Function1'
real_T scanningModelClass::scanning_interp1_nz3(const real_T varargin_2[5],
  real_T varargin_3)
{
  real_T Vq;
  real_T pp_coefs[16];
  real_T signd1;
  real_T xloc;
  int32_T low_i;
  int32_T low_ip1;
  int32_T high_i;
  int32_T mid_i;
  static const int32_T b[5] = { 10000, 20000, 40000, 80000, 160000 };

  real_T del_idx_0;
  real_T del_idx_1;
  real_T slopes_idx_0;
  real_T del_idx_3;
  real_T del_idx_2;
  real_T slopes_idx_4;
  real_T slopes_idx_1;
  real_T slopes_idx_2;
  real_T slopes_idx_3;
  del_idx_0 = (varargin_2[1] - varargin_2[0]) / 10000.0;
  del_idx_1 = (varargin_2[2] - varargin_2[1]) / 20000.0;
  del_idx_2 = (varargin_2[3] - varargin_2[2]) / 40000.0;
  del_idx_3 = (varargin_2[4] - varargin_2[3]) / 80000.0;
  slopes_idx_1 = scanning_interiorSlope(del_idx_0, del_idx_1,
    0.44444444444444442, 0.55555555555555558);
  slopes_idx_2 = scanning_interiorSlope(del_idx_1, del_idx_2,
    0.44444444444444442, 0.55555555555555558);
  slopes_idx_3 = scanning_interiorSlope(del_idx_2, del_idx_3,
    0.44444444444444442, 0.55555555555555558);
  xloc = (40000.0 * del_idx_0 - 10000.0 * del_idx_1) / 30000.0;
  if (del_idx_0 < 0.0) {
    signd1 = -1.0;
  } else if (del_idx_0 > 0.0) {
    signd1 = 1.0;
  } else if (del_idx_0 == 0.0) {
    signd1 = 0.0;
  } else {
    signd1 = del_idx_0;
  }

  if (xloc < 0.0) {
    slopes_idx_4 = -1.0;
  } else if (xloc > 0.0) {
    slopes_idx_4 = 1.0;
  } else if (xloc == 0.0) {
    slopes_idx_4 = 0.0;
  } else {
    slopes_idx_4 = xloc;
  }

  if (slopes_idx_4 != signd1) {
    xloc = 0.0;
  } else {
    if (del_idx_1 < 0.0) {
      slopes_idx_4 = -1.0;
    } else if (del_idx_1 > 0.0) {
      slopes_idx_4 = 1.0;
    } else if (del_idx_1 == 0.0) {
      slopes_idx_4 = 0.0;
    } else {
      slopes_idx_4 = del_idx_1;
    }

    if ((signd1 != slopes_idx_4) && (std::abs(xloc) > std::abs(3.0 * del_idx_0)))
    {
      xloc = 3.0 * del_idx_0;
    }
  }

  slopes_idx_0 = xloc;
  xloc = (200000.0 * del_idx_3 - 80000.0 * del_idx_2) / 120000.0;
  if (del_idx_3 < 0.0) {
    signd1 = -1.0;
  } else if (del_idx_3 > 0.0) {
    signd1 = 1.0;
  } else if (del_idx_3 == 0.0) {
    signd1 = 0.0;
  } else {
    signd1 = del_idx_3;
  }

  if (xloc < 0.0) {
    slopes_idx_4 = -1.0;
  } else if (xloc > 0.0) {
    slopes_idx_4 = 1.0;
  } else if (xloc == 0.0) {
    slopes_idx_4 = 0.0;
  } else {
    slopes_idx_4 = xloc;
  }

  if (slopes_idx_4 != signd1) {
    xloc = 0.0;
  } else {
    if (del_idx_2 < 0.0) {
      slopes_idx_4 = -1.0;
    } else if (del_idx_2 > 0.0) {
      slopes_idx_4 = 1.0;
    } else if (del_idx_2 == 0.0) {
      slopes_idx_4 = 0.0;
    } else {
      slopes_idx_4 = del_idx_2;
    }

    if ((signd1 != slopes_idx_4) && (std::abs(xloc) > std::abs(3.0 * del_idx_3)))
    {
      xloc = 3.0 * del_idx_3;
    }
  }

  slopes_idx_4 = xloc;
  signd1 = (del_idx_0 - slopes_idx_0) / 10000.0;
  xloc = (slopes_idx_1 - del_idx_0) / 10000.0;
  pp_coefs[0] = (xloc - signd1) / 10000.0;
  pp_coefs[4] = 2.0 * signd1 - xloc;
  pp_coefs[8] = slopes_idx_0;
  pp_coefs[12] = varargin_2[0];
  signd1 = (del_idx_1 - slopes_idx_1) / 20000.0;
  xloc = (slopes_idx_2 - del_idx_1) / 20000.0;
  pp_coefs[1] = (xloc - signd1) / 20000.0;
  pp_coefs[5] = 2.0 * signd1 - xloc;
  pp_coefs[9] = slopes_idx_1;
  pp_coefs[13] = varargin_2[1];
  signd1 = (del_idx_2 - slopes_idx_2) / 40000.0;
  xloc = (slopes_idx_3 - del_idx_2) / 40000.0;
  pp_coefs[2] = (xloc - signd1) / 40000.0;
  pp_coefs[6] = 2.0 * signd1 - xloc;
  pp_coefs[10] = slopes_idx_2;
  pp_coefs[14] = varargin_2[2];
  signd1 = (del_idx_3 - slopes_idx_3) / 80000.0;
  xloc = (slopes_idx_4 - del_idx_3) / 80000.0;
  pp_coefs[3] = (xloc - signd1) / 80000.0;
  pp_coefs[7] = 2.0 * signd1 - xloc;
  pp_coefs[11] = slopes_idx_3;
  pp_coefs[15] = varargin_2[3];
  if (rtIsNaN(varargin_3)) {
    Vq = (rtNaN);
  } else {
    if (rtIsNaN(varargin_3)) {
      signd1 = varargin_3;
    } else {
      low_i = 0;
      low_ip1 = 2;
      high_i = 5;
      while (high_i > low_ip1) {
        mid_i = ((low_i + high_i) + 1) >> 1;
        if (varargin_3 >= b[mid_i - 1]) {
          low_i = mid_i - 1;
          low_ip1 = mid_i + 1;
        } else {
          high_i = mid_i;
        }
      }

      xloc = varargin_3 - (real_T)b[low_i];
      signd1 = ((xloc * pp_coefs[low_i] + pp_coefs[low_i + 4]) * xloc +
                pp_coefs[low_i + 8]) * xloc + pp_coefs[low_i + 12];
    }

    Vq = signd1;
  }

  return Vq;
}

// Function for MATLAB Function: '<Root>/MATLAB Function1'
void scanningModelClass::scanning_getSailForce_ground(real_T WindAngle_ground,
  real_T SailAngle_ground, real_T WindSpeed, real_T *SailForce, real_T
  *SailForceAngle_ground, real_T *Attack_angle)
{
  real_T Re;
  real_T SailForce_lift_1;
  real_T SailForce_drag_1;
  real_T SailForce_lift_2;
  real_T SailForce_lift_16;
  real_T SailForce_drag_16;
  real_T Vq;
  real_T b_Vq;
  real_T c_Vq;
  real_T d_Vq;
  real_T e_Vq;
  real_T SailForce_drag_1_0[5];
  real_T SailForce_lift_1_0[5];
  static real_T h_breaks[59] = { 0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0,
    9.0, 10.0, 11.0, 12.0, 13.0, 14.0, 15.0, 16.0, 17.0, 18.0, 19.0, 20.0, 21.0,
    22.0, 23.0, 24.0, 25.0, 26.0, 27.0, 30.0, 35.0, 40.0, 45.0, 50.0, 55.0, 60.0,
    65.0, 70.0, 75.0, 80.0, 85.0, 90.0, 95.0, 100.0, 105.0, 110.0, 115.0, 120.0,
    125.0, 130.0, 135.0, 140.0, 145.0, 150.0, 155.0, 160.0, 165.0, 170.0, 175.0,
    180.0 };

  static real_T h_coefs[232] = { -3.3333333333331776E-5, 4.7162794503119443E-18,
    -0.00014035087719298667, -8.2017543859648381E-5, 0.00091000000000000022,
    -0.0087435024154589435, 0.0016425120772946902, -0.0016956521739130547,
    0.00048148148148148551, 0.00041481481481481404, -0.0010666666666666689,
    0.00048484848484849075, -2.9437229437250662E-5, -2.7799227799212012E-5,
    -0.00051351351351349925, 0.00094999999999997517, -0.001049999999999985,
    0.00048837209302327045, -0.000511627906976786, 0.00048888888888894491,
    -2.1749408983480489E-5, -2.0842379505021241E-5, -0.00051020408163259673,
    0.000490196078431343, -1.9237883832807362E-5, -1.8524871355004441E-5,
    0.0025497326203208111, -0.00071011273981005051, 3.5339805825242154E-5,
    -8.4848484848485387E-5, 1.2100667693889513E-5, 1.5467671060889612E-5,
    1.8126361655774747E-5, -6.7348678601876074E-5, 8.4280936454854477E-6,
    -3.4615384615385018E-5, -5.1739130434783336E-5, -6.0200668896320189E-5,
    -9.8461538461538722E-5, 0.0, 0.00012800000000000008, -1.2000000000000026E-5,
    4.78260869565221E-5, 1.4032983508244982E-5, 2.8559837728196134E-5,
    -4.5451936872311361E-5, 7.3861788617886763E-5, -1.4937106918239405E-5,
    -1.1270440251571198E-5, 4.6545454545453139E-5, 2.3549783549786618E-6,
    0.00014860554371002173, 0.00017491366695932068, -0.00013044375644994833,
    -3.7894736842105235E-5, 2.0571428571428407E-5, 0.00030578881987577657,
    0.00010521739130434787, 0.00013333333333332944, 0.00013333333333332472,
    0.00040701754385965704, 0.00025570175438596287, -0.00080166666666666754,
    0.017125169082125614, -0.0019806763285024221, 0.003391304347826106,
    -0.000481481481481489, 0.00010370370370370481, 0.0021333333333333378,
    -0.00048484848484849075, 0.00054458874458877468, 0.00054208494208491179,
    0.0010270270270270124, -0.00094999999999996129, 0.00209999999999997,
    -0.00048837209302327045, 0.0010232558139535441, -0.00048888888888897267,
    0.00053286052009461973, 0.00053148067737736338, 0.0010204081632652212,
    -0.0004901960784313153, 0.00052904180540143744, 0.0005279588336191271,
    -0.0020406417112298729, 0.0039996192651817752, -0.00035339805825242154,
    0.00042424242424242696, -0.00043626091422702617, -0.00036208411801630852,
    -0.00028322440087147073, 0.0002387041773231083, -0.00040735785953177552,
    -0.00010384615384615022, -9.1304347826083642E-5, -9.0301003344487435E-5,
    0.00018461538461538648, 0.0, -0.0014400000000000012, -0.00017999999999999998,
    -0.00073913043478261091, -0.000409295352323831, -0.00047383367139960453,
    1.5494978479208693E-5, -0.00093028455284553473, -0.00013364779874213626,
    -0.0002606289308176184, -0.00065939393939392775, -0.00021783549783550152,
    -0.0009487420042643941, -0.00041188176763242291, 0.0015149638802889568,
    0.00037894736842105232, -0.00010285714285714203, -0.0014318012422360263,
    4.7826086956521789E-5, 0.0001000000000000046, 0.00026666666666666814,
    0.00053333333333333173, 0.00092631578947368579, 0.0011916666666666664,
    0.002318333333333332, 0.010338164251207727, 0.011304347826086953,
    0.013000000000000001, 0.01348148148148148, 0.014933333333333331, 0.016,
    0.016484848484848491, 0.017485714285714288, 0.018486486486486476,
    0.019000000000000003, 0.019950000000000006, 0.020999999999999991,
    0.021488372093023261, 0.021999999999999992, 0.022488888888888881,
    0.023489361702127679, 0.024489795918367342, 0.024999999999999994,
    0.025490196078431393, 0.026490566037735846, 0.027490909090909087,
    0.031058823529411774, 0.035883495145631064, 0.03500000000000001,
    0.032878787878787875, 0.029423728813559327, 0.026962962962962963,
    0.025490196078431362, 0.022826086956521739, 0.019384615384615392,
    0.015750000000000014, 0.010956521739130427, 0.005538461538461539, 0.0, 0.0,
    -0.0048000000000000048, -0.0075000000000000067, -0.011304347826086959,
    -0.014344827586206895, -0.01694117647058823, -0.020195121951219495,
    -0.023958333333333335, -0.026415094339622653, -0.029866666666666677,
    -0.032969696969696968, -0.034971428571428584, -0.033313432835820896,
    -0.024313725490196073, -0.018947368421052629, -0.018, -0.017485714285714288,
    -0.0088695652173913057, 0.0265, 0.0267, 0.0271, 0.0279, 0.029, 0.0303, 0.041,
    0.051, 0.064, 0.077, 0.091, 0.107, 0.123, 0.14, 0.158, 0.177, 0.196, 0.217,
    0.238, 0.26, 0.282, 0.305, 0.329, 0.354, 0.379, 0.405, 0.432, 0.46, 0.57,
    0.745, 0.92, 1.075, 1.215, 1.345, 1.47, 1.575, 1.665, 1.735, 1.78, 1.8, 1.8,
    1.78, 1.75, 1.7, 1.635, 1.555, 1.465, 1.35, 1.225, 1.085, 0.925, 0.755,
    0.575, 0.42, 0.32, 0.23, 0.14, 0.055 };

  static real_T g_coefs[232] = { -1.929490233448794E-6, -0.002959538185885624,
    0.0011506811896449948, -0.0024931880845856791, -0.0056383097821383621,
    -0.031946901660916974, -0.0074600698486611688, 0.042986180857088885,
    0.53458618085708887, 0.028200000000000003, -0.02147210682492582,
    -0.0047399034350953037, -0.0029447040364156823, -0.00073089757402943628,
    0.0001390600452669255, -6.2662743682592725E-5, -0.00050575962207351222,
    4.976709491985587E-5, -0.00010018621973931913, 4.9953574744701634E-5,
    -9.2764458337057931E-8, -0.00010009267840589697, 9.9907321593969978E-5,
    -5.00463392028444E-5, 4.99537465308772E-5, 0.00068969850496321261,
    -0.03578470052174864, 0.0014935147195522887, -0.00079880793546929991,
    -8.2062855239150957E-5, -5.0745142857143747E-5, 0.00015157894736842118,
    0.0001377858439201457, -4.8664898320071169E-5, 0.00010880167451596048,
    6.3673469387755252E-5, -1.962264150943402E-5, 2.0377358490566156E-5,
    -1.9636363636363896E-5, 2.0363636363636555E-5, 4.1481481481481507E-5,
    -7.7037037037037121E-5, 8.2962962962963014E-5, -1.812636165577308E-5,
    0.00011675579322638062, -8.3095823095822026E-5, -1.9459459459459788E-5,
    4.2352941176470178E-5, 0.00011004524886877947, 0.00030769230769230689,
    -0.00048761904761904733, -0.00038327122153209158, -0.00028083735909822824,
    -0.00014518518518518542, 0.00015069767441860498, 0.0021506976744186035,
    -0.00067952941176470578, -0.0010395294117647069, -0.00044807050976654328,
    0.0025114676761190807, -0.0043430724939928222, 0.00053489819928848048,
    0.0015897877520212322, 0.02423373347317255, -0.0029798603026775783,
    -0.14968618085708885, -0.78717236171417793, 0.028200000000000003,
    0.04837210682492582, 0.012912010260021117, 0.0070125006465851722,
    0.0019078050002756253, 0.00031493010251633369, 0.00066961255063240077,
    0.001061472558806259, 2.795904209818012E-7, 0.00020037243947860356,
    -4.9953574744722451E-5, 5.0139189713700738E-5, 0.00015013901760885934,
    -0.00014986098239096884, 0.00010009267840575126, -4.9953746530828624E-5,
    -0.00063965225149426042, 0.036544955763316643, -0.0076946179541522467,
    0.006047490792782946, -0.0004450971618941953, -8.8548571428567909E-5,
    -0.0019578947368421068, -0.0016468239564428346, -8.7709991158262828E-5,
    -0.0013696493982208291, -0.00063673469387755255, 9.81132075471701E-5,
    -0.00020377358490566088, 9.8181818181820174E-5, -0.00020363636363636555,
    -0.00020740740740740753, 0.0005777777777777784, -0.00062222222222222258,
    0.0002832244008714582, -0.00048573975044562752, 0.0009336609336609257,
    0.00019459459459459787, -0.00021176470588235089, -0.00036199095022625204,
    -0.0010769230769230717, 0.0056380952380952355, 0.0031544513457556975,
    0.00088244766505635869, 5.1851851851853056E-5, -0.0025534883720930266,
    -0.014706976744186036, 0.010997647058823527, 0.019795294117647064,
    0.10584999999999999, 0.10494807050976655, 0.10109239130434784,
    0.095858289885297182, 0.0894485220301171, 0.075713168187744484,
    0.028339930151338663, 0.0, -0.17041381914291104, -0.14100000000000001, 0.0,
    0.032327893175074188, 0.043932203389830511, 0.049123092573753808,
    0.05074600985221675, 0.051793050193050194, 0.052944287063267217,
    0.0535499533146592, 0.05369981378026073, 0.05379999999999998,
    0.05384995357474464, 0.05394995366079703, 0.053949953660797058,
    0.05394995366079703, 0.054, 0.054049953746530974, 0.054839744758432091,
    0.020575554719819457, 0.014732744422817769, 0.015297057190449735,
    0.00469137142857146, 0.0, -0.00821052631578948, -0.0143448275862069,
    -0.018871794871794866, -0.024408163265306121, -0.026000000000000002,
    -0.026490566037735853, -0.027, -0.02749090909090909, -0.028000000000000004,
    -0.026962962962962966, -0.026962962962962966, -0.026962962962962966,
    -0.025490196078431365, -0.021590909090909095, -0.01848648648648649,
    -0.017999999999999995, -0.016941176470588241, -0.0123076923076923, 0.0,
    0.019809523809523805, 0.02260869565217391, 0.010370370370370377, 0.0,
    -0.014232558139534892, 0.0, 0.05901176470588234, 0.0, 0.1054, 0.2099, 0.3078,
    0.4017, 0.4871, 0.5551, 0.573, 0.4663, 0.0433, -0.0413, -0.0144, 0.0261,
    0.0741, 0.1244, 0.1756, 0.228, 0.2815, 0.3351, 0.3889, 0.4427, 0.4966,
    0.5506, 0.6045, 0.6585, 0.7125, 0.7666, 0.8222, 0.855, 0.98, 1.0351, 1.05,
    1.02, 0.955, 0.875, 0.76, 0.63, 0.5, 0.365, 0.23, 0.09, -0.05, -0.18, -0.32,
    -0.45, -0.575, -0.67, -0.76, -0.85, -0.93, -0.98, -0.9, -0.77, -0.67, -0.635,
    -0.68, -0.85, -0.66 };

  static real_T f_coefs[232] = { -3.3333333333331776E-5, -2.424242424242006E-5,
    -6.7379679144385809E-5, -4.6035805626600305E-5, 3.7681159420304127E-6,
    -0.0001780952380952374, 0.0015094570374275182, -0.022090009023350655,
    -0.0069021766834888136, 0.0048820512820512817, -0.0010666666666666689,
    0.00048484848484849075, -2.9437229437250662E-5, -2.7799227799212012E-5,
    -0.00051351351351349925, 0.00094999999999997517, -0.001049999999999985,
    0.00048837209302327045, -0.000511627906976786, 0.00048888888888894491,
    -2.1749408983480489E-5, -2.0842379505021241E-5, -0.00051020408163259673,
    0.000490196078431343, -1.9237883832807362E-5, -1.8524871355004441E-5,
    0.0025497326203208111, -0.00071011273981005051, 3.5339805825242154E-5,
    -8.4848484848485387E-5, 1.2100667693889513E-5, 1.5467671060889612E-5,
    1.8126361655774747E-5, -6.7348678601876074E-5, 8.4280936454854477E-6,
    -3.4615384615385018E-5, -5.1739130434783336E-5, -6.0200668896320189E-5,
    -9.8461538461538722E-5, 0.0, 0.00012800000000000008, -1.2000000000000026E-5,
    4.78260869565221E-5, 1.4032983508244982E-5, 2.8559837728196134E-5,
    -4.5451936872311361E-5, 7.3861788617886763E-5, -1.4937106918239405E-5,
    -1.1270440251571198E-5, 4.6545454545453139E-5, 2.3549783549786618E-6,
    0.00014860554371002173, 0.00017491366695932068, -0.00013044375644994833,
    -3.7894736842105235E-5, 2.0571428571428407E-5, 0.00030578881987577657,
    0.00010521739130434787, 0.00013333333333332944, 0.0001575757575757495,
    0.00025828877005347809, 0.00022250639386189549, 0.00016579710144927289,
    0.00040476190476190473, -0.0014580284659989453, 0.044029123414494553,
    0.0067530713156955732, -0.00883076923076923, 0.0021333333333333378,
    -0.00048484848484849075, 0.00054458874458877468, 0.00054208494208491179,
    0.0010270270270270124, -0.00094999999999996129, 0.00209999999999997,
    -0.00048837209302327045, 0.0010232558139535441, -0.00048888888888897267,
    0.00053286052009461973, 0.00053148067737736338, 0.0010204081632652212,
    -0.0004901960784313153, 0.00052904180540143744, 0.0005279588336191271,
    -0.0020406417112298729, 0.0039996192651817752, -0.00035339805825242154,
    0.00042424242424242696, -0.00043626091422702617, -0.00036208411801630852,
    -0.00028322440087147073, 0.0002387041773231083, -0.00040735785953177552,
    -0.00010384615384615022, -9.1304347826083642E-5, -9.0301003344487435E-5,
    0.00018461538461538648, 0.0, -0.0014400000000000012, -0.00017999999999999998,
    -0.00073913043478261091, -0.000409295352323831, -0.00047383367139960453,
    1.5494978479208693E-5, -0.00093028455284553473, -0.00013364779874213626,
    -0.0002606289308176184, -0.00065939393939392775, -0.00021783549783550152,
    -0.0009487420042643941, -0.00041188176763242291, 0.0015149638802889568,
    0.00037894736842105232, -0.00010285714285714203, -0.0014318012422360263,
    4.7826086956521789E-5, 0.0001000000000000046, 0.00026666666666666814,
    0.000509090909090907, 0.0008235294117647057, 0.0011304347826086958,
    0.0014733333333333328, 0.00174857142857143, 0.0033608856088560941,
    0.025149105367793242, 0.017948717948717947, 0.014933333333333331, 0.016,
    0.016484848484848491, 0.017485714285714288, 0.018486486486486476,
    0.019000000000000003, 0.019950000000000006, 0.020999999999999991,
    0.021488372093023261, 0.021999999999999992, 0.022488888888888881,
    0.023489361702127679, 0.024489795918367342, 0.024999999999999994,
    0.025490196078431393, 0.026490566037735846, 0.027490909090909087,
    0.031058823529411774, 0.035883495145631064, 0.03500000000000001,
    0.032878787878787875, 0.029423728813559327, 0.026962962962962963,
    0.025490196078431362, 0.022826086956521739, 0.019384615384615392,
    0.015750000000000014, 0.010956521739130427, 0.005538461538461539, 0.0, 0.0,
    -0.0048000000000000048, -0.0075000000000000067, -0.011304347826086959,
    -0.014344827586206895, -0.01694117647058823, -0.020195121951219495,
    -0.023958333333333335, -0.026415094339622653, -0.029866666666666677,
    -0.032969696969696968, -0.034971428571428584, -0.033313432835820896,
    -0.024313725490196073, -0.018947368421052629, -0.018, -0.017485714285714288,
    -0.0088695652173913057, 0.0196, 0.0198, 0.0202, 0.0209, 0.0219, 0.0232,
    0.0249, 0.0267, 0.052, 0.077, 0.091, 0.107, 0.123, 0.14, 0.158, 0.177, 0.196,
    0.217, 0.238, 0.26, 0.282, 0.305, 0.329, 0.354, 0.379, 0.405, 0.432, 0.46,
    0.57, 0.745, 0.92, 1.075, 1.215, 1.345, 1.47, 1.575, 1.665, 1.735, 1.78, 1.8,
    1.8, 1.78, 1.75, 1.7, 1.635, 1.555, 1.465, 1.35, 1.225, 1.085, 0.925, 0.755,
    0.575, 0.42, 0.32, 0.23, 0.14, 0.055 };

  static real_T e_coefs[232] = { 1.3877787807814457E-17, 0.0,
    -0.01185297079556899, 0.014636816438473574, -0.012436528555431106,
    -0.0026964423717521363, -0.010629723427151509, -0.032259596844872833,
    0.0046831156265118579, 0.088763048046260257, 0.31255141652676877,
    0.036471484107020363, -0.015015481832543445, -0.0099445646065926575,
    -0.0022584106762895406, -0.000931106558366819, 0.00024234184921851504,
    0.00013482259263153384, -0.00060948482860134073, -3.7313562711860371E-7,
    -0.00010018621973934688, 4.9953574744736329E-5, -5.0046425255433069E-5,
    1.2490009027033011E-16, 0.00024884579870721596, 0.0013502730957635073,
    -0.041508623810269145, 0.0013926650655469244, -0.0008751274209989814,
    -8.03174603174586E-5, -5.1428571428572235E-5, 0.00015157894736842118,
    0.0001377858439201457, -4.8664898320071169E-5, 0.00010880167451596048,
    6.3673469387755252E-5, -1.962264150943402E-5, 2.0377358490566156E-5,
    -1.9636363636363896E-5, 2.0363636363636555E-5, 2.0363636363636416E-5,
    -1.9636363636363618E-5, 2.0377358490566017E-5, 7.6951535331146069E-7,
    0.00011675579322638062, -8.3095823095822026E-5, -1.9459459459459788E-5,
    4.2352941176470178E-5, 0.00011004524886877947, 0.00030769230769230689,
    -0.00048761904761904733, -0.00038327122153209158, -0.00028083735909822824,
    -0.00014518518518518542, 0.00015069767441860498, 0.0021506976744186035,
    -0.00067952941176470578, -0.0010395294117647069, -2.7755575615628914E-17,
    0.0, 0.011852970795569004, -0.0241838456429046, 0.018146741321388535,
    -0.0031772418387741863, 0.0035998500094300209, 0.021619193689745728,
    -0.026683115626511877, -0.23414616367277205, -0.41923134894651726,
    0.016357031785959292, 0.036815481832543448, 0.022860046439136097,
    0.0056874934503387611, 0.0021604344606071524, 5.9436806907960105E-5,
    0.00042105690202346585, 0.0013187827413148195, 0.0001005600515149585,
    0.00020037243947865907, -4.9953574744757145E-5, 0.00010009285051081757,
    -1.8735013540549517E-16, -0.00024884579870716739, -0.0010991188944708269,
    0.043207196513212927, -0.0071079781608656446, 0.0068068297655453662,
    -0.00045396825396826256, -8.5714285714282609E-5, -0.0019578947368421068,
    -0.0016468239564428346, -8.7709991158262828E-5, -0.0013696493982208291,
    -0.00063673469387755255, 9.81132075471701E-5, -0.00020377358490566088,
    9.8181818181820174E-5, -0.00020363636363636555, -0.00010181818181818209,
    0.00019636363636363617, -0.00010188679245283009, 9.42656307806128E-5,
    -0.00048573975044562752, 0.0009336609336609257, 0.00019459459459459787,
    -0.00021176470588235089, -0.00036199095022625204, -0.0010769230769230717,
    0.0056380952380952355, 0.0031544513457556975, 0.00088244766505635869,
    5.1851851851853056E-5, -0.0025534883720930266, -0.014706976744186036,
    0.010997647058823527, 0.019795294117647064, 0.11000000000000001, 0.11, 0.11,
    0.098147029204431038, 0.09368978723404256, 0.092673684210526311,
    0.078229873417721529, 0.053540403155127043, 0.0, -0.039316884373488181,
    -0.24132006758025151, -0.14212851589297967, 0.0, 0.028584518167456555,
    0.044470917225950778, 0.049070672097759678, 0.050598221343873526,
    0.051444120505344991, 0.052690702087286524, 0.053499813084112141,
    0.0536998137802607, 0.05379999999999998, 0.053849953574744674,
    0.05390000000000001, 0.05390000000000001, 0.054148845798707324,
    0.056001427297056192, 0.017889948892674611, 0.012844036697247704,
    0.015277777777777765, 0.0047142857142857438, 0.0, -0.00821052631578948,
    -0.0143448275862069, -0.018871794871794866, -0.024408163265306121,
    -0.026000000000000002, -0.026490566037735853, -0.027, -0.02749090909090909,
    -0.028000000000000004, -0.027490909090909094, -0.027000000000000003,
    -0.026490566037735853, -0.025490196078431365, -0.021590909090909095,
    -0.01848648648648649, -0.017999999999999995, -0.016941176470588241,
    -0.0123076923076923, 0.0, 0.019809523809523805, 0.02260869565217391,
    0.010370370370370377, 0.0, -0.014232558139534892, 0.0, 0.05901176470588234,
    0.0, 0.11, 0.22, 0.33, 0.4186, 0.518, 0.6048, 0.676, 0.7189, 0.6969, 0.5122,
    0.1642, 0.0749, 0.0967, 0.1382, 0.1861, 0.2364, 0.2873, 0.3393, 0.3927,
    0.4463, 0.5001, 0.5539, 0.6078, 0.6617, 0.7156, 0.77, 0.8277, 0.855, 0.98,
    1.035, 1.05, 1.02, 0.955, 0.875, 0.76, 0.63, 0.5, 0.365, 0.23, 0.09, -0.05,
    -0.185, -0.32, -0.45, -0.575, -0.67, -0.76, -0.85, -0.93, -0.98, -0.9, -0.77,
    -0.67, -0.635, -0.68, -0.85, -0.66 };

  static real_T d_coefs[232] = { -4.9999999999999264E-5, -7.4999999999999E-5,
    8.0882352941177372E-5, -0.0004461176470588233, 8.2482758620685843E-5,
    -0.00011703239289445741, 8.6322686322685537E-5, -0.0001133816743572871,
    -2.3823028927928702E-6, 0.0019571540409854932, -0.044750549904938021,
    -0.021390116736621181, 0.008454464285714277, -2.7799227799212012E-5,
    -0.00051351351351349925, 0.00094999999999997517, -0.001049999999999985,
    0.00048837209302327045, -0.000511627906976786, 0.00048888888888894491,
    -2.1749408983480489E-5, -2.0842379505021241E-5, -0.00051020408163259673,
    0.000490196078431343, -1.9237883832807362E-5, -1.8524871355004441E-5,
    0.0025497326203208111, -0.00071011273981005051, 3.5339805825242154E-5,
    -8.4848484848485387E-5, 1.2100667693889513E-5, 1.5467671060889612E-5,
    1.8126361655774747E-5, -9.15032679738563E-5, 6.8376068376067731E-5,
    -9.5664335664334812E-5, -3.6890645586298844E-5, -6.0200668896320189E-5,
    -9.8461538461538722E-5, 0.0, 0.00012800000000000008, -1.2000000000000026E-5,
    4.78260869565221E-5, 1.4032983508244982E-5, 2.8559837728196134E-5,
    -4.5451936872311361E-5, 7.3861788617886763E-5, -1.4937106918239405E-5,
    -1.1270440251571198E-5, 4.6545454545453139E-5, 2.3549783549786618E-6,
    0.00014860554371002173, 0.00017491366695932068, -0.00013044375644994833,
    -3.7894736842105235E-5, 2.0571428571428407E-5, 0.00030578881987577657,
    0.00010521739130434787, 0.00014999999999999866, 0.00022499999999999766,
    4.4117647058821764E-5, 0.00094023529411764776, -3.0482758620684145E-5,
    0.00028254963427376458, -3.4807534807532441E-5, 0.00027554383651945012,
    5.3601815087912872E-5, -0.0019059912502878175, 0.088842233073254839,
    0.020748983473242381, -0.016423214285714281, 0.00054208494208491179,
    0.0010270270270270124, -0.00094999999999996129, 0.00209999999999997,
    -0.00048837209302327045, 0.0010232558139535441, -0.00048888888888897267,
    0.00053286052009461973, 0.00053148067737736338, 0.0010204081632652212,
    -0.0004901960784313153, 0.00052904180540143744, 0.0005279588336191271,
    -0.0020406417112298729, 0.0039996192651817752, -0.00035339805825242154,
    0.00042424242424242696, -0.00043626091422702617, -0.00036208411801630852,
    -0.00028322440087147073, 0.00035947712418300944, -0.00078632478632478179,
    0.00038088578088577431, -0.00023978919631092858, -9.0301003344487435E-5,
    0.00018461538461538648, 0.0, -0.0014400000000000012, -0.00017999999999999998,
    -0.00073913043478261091, -0.000409295352323831, -0.00047383367139960453,
    1.5494978479208693E-5, -0.00093028455284553473, -0.00013364779874213626,
    -0.0002606289308176184, -0.00065939393939392775, -0.00021783549783550152,
    -0.0009487420042643941, -0.00041188176763242291, 0.0015149638802889568,
    0.00037894736842105232, -0.00010285714285714203, -0.0014318012422360263,
    4.7826086956521789E-5, 1.7347234759768071E-18, 0.00015000000000000126,
    0.00037499999999999957, 0.00070588235294117522, 0.0012480000000000008,
    0.00143448275862069, 0.001648484848484847, 0.0018378378378378388,
    0.0020487804878048777, 0.0021488372093023248, 0.0042083168316831695,
    0.0476411332633788, 0.024968750000000019, 0.017485714285714288,
    0.018486486486486476, 0.019000000000000003, 0.019950000000000006,
    0.020999999999999991, 0.021488372093023261, 0.021999999999999992,
    0.022488888888888881, 0.023489361702127679, 0.024489795918367342,
    0.024999999999999994, 0.025490196078431393, 0.026490566037735846,
    0.027490909090909087, 0.031058823529411774, 0.035883495145631064,
    0.03500000000000001, 0.032878787878787875, 0.029423728813559327,
    0.026962962962962963, 0.025490196078431362, 0.022222222222222233,
    0.019487179487179495, 0.016121212121212126, 0.010956521739130427,
    0.005538461538461539, 0.0, 0.0, -0.0048000000000000048,
    -0.0075000000000000067, -0.011304347826086959, -0.014344827586206895,
    -0.01694117647058823, -0.020195121951219495, -0.023958333333333335,
    -0.026415094339622653, -0.029866666666666677, -0.032969696969696968,
    -0.034971428571428584, -0.033313432835820896, -0.024313725490196073,
    -0.018947368421052629, -0.018, -0.017485714285714288, -0.0088695652173913057,
    0.0147, 0.0148, 0.0151, 0.0156, 0.0168, 0.0181, 0.0197, 0.0214, 0.0234,
    0.0255, 0.0277, 0.076, 0.123, 0.14, 0.158, 0.177, 0.196, 0.217, 0.238, 0.26,
    0.282, 0.305, 0.329, 0.354, 0.379, 0.405, 0.432, 0.46, 0.57, 0.745, 0.92,
    1.075, 1.215, 1.345, 1.47, 1.57, 1.665, 1.735, 1.78, 1.8, 1.8, 1.78, 1.75,
    1.7, 1.635, 1.555, 1.465, 1.35, 1.225, 1.085, 0.925, 0.755, 0.575, 0.42,
    0.32, 0.23, 0.14, 0.055 };

  static real_T c_coefs[232] = { 1.3877787807814457E-17, 0.0,
    -2.7755575615628914E-17, 4.163336342344337E-17, -0.01743549236440238,
    0.015182568241658312, -0.010906810527959956, -0.0077762061900069693,
    -0.034302715098448767, -5.1380042462854155E-5, 0.040955658005029413,
    0.040835118127728595, 0.12219777709324642, 0.077718316970546986,
    -1.7006802721088567E-5, -0.022153017883053506, -0.0069078514350995948,
    -0.0004183279580729643, -0.0010514479207661062, -0.00035540106182857523,
    0.00044260944868190766, 3.5086008318807593E-5, -0.00065796418473136609,
    9.9814126394093261E-5, 0.00029686753339211447, 0.0026201967576026733,
    -0.052565281366540741, 0.0010447476588928018, -0.0010412427430016669,
    -8.03174603174586E-5, -5.1428571428572235E-5, 0.00015157894736842118,
    0.0001377858439201457, -4.8664898320071169E-5, 0.00010880167451596048,
    6.3673469387755252E-5, -1.962264150943402E-5, 2.0377358490566156E-5,
    -1.9636363636363896E-5, 2.0363636363636555E-5, 2.0363636363636416E-5,
    -1.9636363636363618E-5, 2.0377358490566017E-5, 7.6951535331146069E-7,
    0.00011675579322638062, -8.3095823095822026E-5, -1.9459459459459788E-5,
    4.2352941176470178E-5, 0.00011004524886877947, 0.00030769230769230689,
    -0.00048761904761904733, -0.00038327122153209158, -0.00028083735909822824,
    -0.00014518518518518542, 0.00015069767441860498, 0.0021506976744186035,
    -0.00067952941176470578, -0.0010395294117647069, -2.7755575615628914E-17,
    0.0, 4.163336342344337E-17, -5.5511151231257827E-17, 0.017435492364402408,
    -0.027847075877256031, 0.013588749921899346, 0.0010010773240276341,
    0.024754050154434951, -0.00099723991507439259, -0.11085565800502949,
    -0.11069077613275782, -0.16327723721594584, -0.037736633941093972,
    0.000517006802721089, 0.0500700246857746, 0.015543862515432001,
    0.0022901683128401448, 0.0025979355240718927, 0.00086036137928889589,
    -0.00029216870431363062, 0.00057186379863098658, 0.0013159283694627322,
    -9.9814126394093261E-5, -0.00019668165978611873, -0.0022172501646008716,
    0.055942138015936227, -0.0052381014042966268, 0.0084679829855722217,
    -0.00045396825396826256, -8.5714285714282609E-5, -0.0019578947368421068,
    -0.0016468239564428346, -8.7709991158262828E-5, -0.0013696493982208291,
    -0.00063673469387755255, 9.81132075471701E-5, -0.00020377358490566088,
    9.8181818181820174E-5, -0.00020363636363636555, -0.00010181818181818209,
    0.00019636363636363617, -0.00010188679245283009, 9.42656307806128E-5,
    -0.00048573975044562752, 0.0009336609336609257, 0.00019459459459459787,
    -0.00021176470588235089, -0.00036199095022625204, -0.0010769230769230717,
    0.0056380952380952355, 0.0031544513457556975, 0.00088244766505635869,
    5.1851851851853056E-5, -0.0025534883720930266, -0.014706976744186036,
    0.010997647058823527, 0.019795294117647064, 0.11000000000000001, 0.11, 0.11,
    0.11, 0.11000000000000001, 0.09256450763559769, 0.082418060606060564,
    0.076875128865979386, 0.055548664944013747, 0.0021486199575373476, 0.0,
    -0.098844341994970733, -0.19772053987730059, -0.157681683029453, 0.0,
    0.00098299319727891232, 0.0346639889196676, 0.045028159645232817,
    0.048353512396694213, 0.05039503968253968, 0.051049559255631746,
    0.051793050193050208, 0.053042035815268604, 0.05369999999999997,
    0.053799814126394063, 0.054297053406998169, 0.057723143350604446,
    0.011911575282854676, 0.0086911536471805644, 0.015277777777777765,
    0.0047142857142857438, 0.0, -0.00821052631578948, -0.0143448275862069,
    -0.018871794871794866, -0.024408163265306121, -0.026000000000000002,
    -0.026490566037735853, -0.027, -0.02749090909090909, -0.028000000000000004,
    -0.027490909090909094, -0.027000000000000003, -0.026490566037735853,
    -0.025490196078431365, -0.021590909090909095, -0.01848648648648649,
    -0.017999999999999995, -0.016941176470588241, -0.0123076923076923, 0.0,
    0.019809523809523805, 0.02260869565217391, 0.010370370370370377, 0.0,
    -0.014232558139534892, 0.0, 0.05901176470588234, 0.0, 0.11, 0.22, 0.33, 0.44,
    0.55, 0.6299, 0.715, 0.7851, 0.8311, 0.8322, 0.7623, 0.5936, 0.3548, 0.2371,
    0.2376, 0.2665, 0.3098, 0.3567, 0.4066, 0.4575, 0.5087, 0.5611, 0.6148,
    0.6685, 0.7224, 0.7771, 0.8382, 0.855, 0.98, 1.035, 1.05, 1.02, 0.955, 0.875,
    0.76, 0.63, 0.5, 0.365, 0.23, 0.09, -0.05, -0.185, -0.32, -0.45, -0.575,
    -0.67, -0.76, -0.85, -0.93, -0.98, -0.9, -0.77, -0.67, -0.635, -0.68, -0.85,
    -0.66 };

  static real_T b_coefs[232] = { -9.99999999999989E-6, -1.7142857142856983E-5,
    7.6190476190476713E-5, -0.00017777777777777844, 0.000174603174603174,
    -0.00062016806722688892, 0.00014260249554367134, 4.2929292929292729E-5,
    -1.0555555555554017E-5, -9.5454545454565221E-6, -8.7121212121211988E-6,
    -0.00032155797101449069, 0.0021664031620553361, -0.070118385370109074,
    -0.041204330374146635, 0.011397849462365585, 0.0004878048780487948,
    -2.3823028927949519E-5, -0.000511627906976786, 0.00048888888888894491,
    -2.1749408983480489E-5, -2.0842379505021241E-5, -0.001020408163265249,
    0.0019015606242496763, -0.0015882352941176715, 0.00049090909090914944,
    0.0025497326203208111, -0.00071011273981005051, 3.5339805825242154E-5,
    -8.4848484848485387E-5, 1.2100667693889513E-5, 1.5467671060889612E-5,
    1.8126361655774747E-5, -6.7348678601876074E-5, 8.4280936454854477E-6,
    -3.4615384615385018E-5, -5.1739130434783336E-5, -6.0200668896320189E-5,
    -9.8461538461538722E-5, 0.0, 0.00012800000000000008, -1.2000000000000026E-5,
    4.78260869565221E-5, 1.4032983508244982E-5, 2.8559837728196134E-5,
    -4.5451936872311361E-5, 7.3861788617886763E-5, -1.4937106918239405E-5,
    -1.1270440251571198E-5, 4.6545454545453139E-5, 2.3549783549786618E-6,
    0.00014860554371002173, 0.00017491366695932068, -0.00013044375644994833,
    -3.7894736842105235E-5, 2.0571428571428407E-5, 0.00030578881987577657,
    0.00010521739130434787, 5.9999999999999588E-5, 7.7142857142856571E-5,
    -1.9047619047619924E-5, 0.000444444444444446, -6.3492063492062581E-5,
    0.0011344537815126021, -0.00023672014260249443, 8.5858585858584156E-6,
    0.00011611111111110893, 0.00011454545454545788, 0.00011325757575757515,
    0.00042572463768115673, -0.002349011857707509, 0.1398345909037059,
    0.04080651021065889, -0.022795698924731184, -0.00048780487804880868,
    0.00053601815087916949, 0.0010232558139535441, -0.00048888888888897267,
    0.00053286052009461973, 0.00053148067737736338, 0.0015306122448978735,
    -0.0023913565426169972, 0.0031764705882353188, -0.00049090909090918067,
    -0.0020406417112298729, 0.0039996192651817752, -0.00035339805825242154,
    0.00042424242424242696, -0.00043626091422702617, -0.00036208411801630852,
    -0.00028322440087147073, 0.0002387041773231083, -0.00040735785953177552,
    -0.00010384615384615022, -9.1304347826083642E-5, -9.0301003344487435E-5,
    0.00018461538461538648, 0.0, -0.0014400000000000012, -0.00017999999999999998,
    -0.00073913043478261091, -0.000409295352323831, -0.00047383367139960453,
    1.5494978479208693E-5, -0.00093028455284553473, -0.00013364779874213626,
    -0.0002606289308176184, -0.00065939393939392775, -0.00021783549783550152,
    -0.0009487420042643941, -0.00041188176763242291, 0.0015149638802889568,
    0.00037894736842105232, -0.00010285714285714203, -0.0014318012422360263,
    4.7826086956521789E-5, 0.00015000000000000083, 0.00024000000000000033,
    0.00034285714285714253, 0.00053333333333333282, 0.00088888888888888947,
    0.0012857142857142863, 0.0016941176470588238, 0.001648484848484849,
    0.001794444444444444, 0.001995, 0.002195454545454546, 0.0023958333333333327,
    0.0022826086956521741, 0.0040837944664031643, 0.07339782016348774,
    0.031397849462365617, 0.020000000000000004, 0.020487804878048771,
    0.021488372093023261, 0.021999999999999992, 0.022488888888888881,
    0.023489361702127679, 0.024489795918367342, 0.024489795918367342,
    0.025411764705882377, 0.027, 0.027490909090909087, 0.031058823529411774,
    0.035883495145631064, 0.03500000000000001, 0.032878787878787875,
    0.029423728813559327, 0.026962962962962963, 0.025490196078431362,
    0.022826086956521739, 0.019384615384615392, 0.015750000000000014,
    0.010956521739130427, 0.005538461538461539, 0.0, 0.0, -0.0048000000000000048,
    -0.0075000000000000067, -0.011304347826086959, -0.014344827586206895,
    -0.01694117647058823, -0.020195121951219495, -0.023958333333333335,
    -0.026415094339622653, -0.029866666666666677, -0.032969696969696968,
    -0.034971428571428584, -0.033313432835820896, -0.024313725490196073,
    -0.018947368421052629, -0.018, -0.017485714285714288, -0.0088695652173913057,
    0.0115, 0.0117, 0.012, 0.0124, 0.0132, 0.0142, 0.016, 0.0176, 0.0193, 0.0212,
    0.0233, 0.0256, 0.0281, 0.0302, 0.104, 0.177, 0.197, 0.217, 0.238, 0.26,
    0.282, 0.305, 0.329, 0.354, 0.378, 0.405, 0.432, 0.46, 0.57, 0.745, 0.92,
    1.075, 1.215, 1.345, 1.47, 1.575, 1.665, 1.735, 1.78, 1.8, 1.8, 1.78, 1.75,
    1.7, 1.635, 1.555, 1.465, 1.35, 1.225, 1.085, 0.925, 0.755, 0.575, 0.42,
    0.32, 0.23, 0.14, 0.055 };

  // 
  // 
  *Attack_angle = scanning_AngleDiff_f(SailAngle_ground, WindAngle_ground);
  Re = 1.21 * WindSpeed * 0.25 / 1.7899999999999998E-5;
  SailForce_lift_1 = scanning_interp1(std::abs(*Attack_angle) /
    3.1415926535897931 * 180.0) * 0.5 * 1.21 * (WindSpeed * WindSpeed) * 0.55;
  SailForce_drag_1 = scanning_interp1_n(std::abs(*Attack_angle) /
    3.1415926535897931 * 180.0) * 0.5 * 1.21 * (WindSpeed * WindSpeed) * 0.55;
  SailForce_lift_2 = scanning_interp1_nz(std::abs(*Attack_angle) /
    3.1415926535897931 * 180.0) * 0.5 * 1.21 * (WindSpeed * WindSpeed) * 0.55;
  SailForce_drag_16 = std::abs(*Attack_angle) / 3.1415926535897931 * 180.0;
  if (rtIsNaN(SailForce_drag_16)) {
    Vq = (rtNaN);
  } else {
    Vq = scanning_ppval(h_breaks, h_coefs, SailForce_drag_16);
  }

  SailForce_drag_16 = std::abs(*Attack_angle) / 3.1415926535897931 * 180.0;
  if (rtIsNaN(SailForce_drag_16)) {
    b_Vq = (rtNaN);
  } else {
    b_Vq = scanning_ppval(h_breaks, g_coefs, SailForce_drag_16);
  }

  SailForce_drag_16 = std::abs(*Attack_angle) / 3.1415926535897931 * 180.0;
  if (rtIsNaN(SailForce_drag_16)) {
    c_Vq = (rtNaN);
  } else {
    c_Vq = scanning_ppval(h_breaks, f_coefs, SailForce_drag_16);
  }

  SailForce_drag_16 = std::abs(*Attack_angle) / 3.1415926535897931 * 180.0;
  if (rtIsNaN(SailForce_drag_16)) {
    d_Vq = (rtNaN);
  } else {
    d_Vq = scanning_ppval(h_breaks, e_coefs, SailForce_drag_16);
  }

  SailForce_drag_16 = std::abs(*Attack_angle) / 3.1415926535897931 * 180.0;
  if (rtIsNaN(SailForce_drag_16)) {
    e_Vq = (rtNaN);
  } else {
    e_Vq = scanning_ppval(h_breaks, d_coefs, SailForce_drag_16);
  }

  SailForce_drag_16 = std::abs(*Attack_angle) / 3.1415926535897931 * 180.0;
  if (rtIsNaN(SailForce_drag_16)) {
    SailForce_drag_16 = (rtNaN);
  } else {
    SailForce_drag_16 = scanning_ppval(h_breaks, c_coefs, SailForce_drag_16);
  }

  SailForce_lift_16 = SailForce_drag_16 * 0.5 * 1.21 * (WindSpeed * WindSpeed) *
    0.55;
  SailForce_drag_16 = std::abs(*Attack_angle) / 3.1415926535897931 * 180.0;
  if (rtIsNaN(SailForce_drag_16)) {
    SailForce_drag_16 = (rtNaN);
  } else {
    SailForce_drag_16 = scanning_ppval(h_breaks, b_coefs, SailForce_drag_16);
  }

  SailForce_drag_16 = SailForce_drag_16 * 0.5 * 1.21 * (WindSpeed * WindSpeed) *
    0.55;
  if (Re < 10000.0) {
    SailForce_lift_16 = SailForce_lift_1;
    SailForce_drag_16 = SailForce_drag_1;
  } else {
    if (!(Re > 160000.0)) {
      SailForce_lift_1_0[0] = SailForce_lift_1;
      SailForce_lift_1_0[1] = SailForce_lift_2;
      SailForce_lift_1_0[2] = b_Vq * 0.5 * 1.21 * (WindSpeed * WindSpeed) * 0.55;
      SailForce_lift_1_0[3] = d_Vq * 0.5 * 1.21 * (WindSpeed * WindSpeed) * 0.55;
      SailForce_lift_1_0[4] = SailForce_lift_16;
      SailForce_lift_16 = scanning_interp1_nz3(SailForce_lift_1_0, Re);
      SailForce_drag_1_0[0] = SailForce_drag_1;
      SailForce_drag_1_0[1] = Vq * 0.5 * 1.21 * (WindSpeed * WindSpeed) * 0.55;
      SailForce_drag_1_0[2] = c_Vq * 0.5 * 1.21 * (WindSpeed * WindSpeed) * 0.55;
      SailForce_drag_1_0[3] = e_Vq * 0.5 * 1.21 * (WindSpeed * WindSpeed) * 0.55;
      SailForce_drag_1_0[4] = SailForce_drag_16;
      SailForce_drag_16 = scanning_interp1_nz3(SailForce_drag_1_0, Re);
    }
  }

  // Attack_angle
  if (*Attack_angle < 0.0) {
    Re = -1.0;
  } else if (*Attack_angle > 0.0) {
    Re = 1.0;
  } else if (*Attack_angle == 0.0) {
    Re = 0.0;
  } else {
    Re = *Attack_angle;
  }

  *SailForceAngle_ground = std::atan(SailForce_lift_16 / SailForce_drag_16) * Re
    + (WindAngle_ground + 3.1415926535897931);
  *SailForce = std::sqrt(SailForce_lift_16 * SailForce_lift_16 +
    SailForce_drag_16 * SailForce_drag_16);
}

// Function for MATLAB Function: '<Root>/MATLAB Function1'
real_T scanningModelClass::scanning_HeadingDeadZone(real_T heading_check, real_T
  WindAngle_ground, real_T SailAngle_ground, real_T tacking, real_T
  heading_d_last)
{
  real_T check;
  real_T dead_heading[9];
  int32_T dead_num;
  real_T heading;
  int32_T i;

  // degree ;heading_d_last
  memset(&dead_heading[0], 0, 9U * sizeof(real_T));
  dead_num = 2;
  dead_heading[0] = (WindAngle_ground - 0.57595865315812866) +
    12.566370614359172;
  dead_heading[3] = (WindAngle_ground + 0.57595865315812866) +
    12.566370614359172;
  dead_heading[6] = 1.1519173063162573;
  dead_heading[1] = (SailAngle_ground + 1.7453292519943295) + 12.566370614359172;
  dead_heading[4] = (SailAngle_ground + 4.5378560551852569) + 12.566370614359172;
  dead_heading[7] = 3.1415926535897931;
  if (tacking > 1.5) {
    dead_heading[2] = ((heading_d_last + 66.0) - 3.0) / 180.0 *
      3.1415926535897931 + 12.566370614359172;
    dead_heading[5] = (((heading_d_last - 66.0) + 3.0) + 360.0) / 180.0 *
      3.1415926535897931 + 12.566370614359172;
    dead_heading[8] = 4.0840704496667311;

    // %%%%%dead_zone*2???
    dead_num = 3;
  }

  check = 0.0;
  for (i = 0; i <= dead_num - 2; i++) {
    for (heading = heading_check; heading < dead_heading[i]; heading +=
         6.2831853071795862) {
    }

    if (heading < dead_heading[3 + i]) {
      check = 1.0;
    }
  }

  if ((check < 0.5) && (dead_num > 2.5)) {
    for (heading = heading_check; heading < dead_heading[2]; heading +=
         6.2831853071795862) {
    }

    if (heading < dead_heading[5]) {
      check = 2.0;
    }
  }

  return check;
}

// Model step function
void scanningModelClass::step()
{
  real_T Horizontal_speed_angle;
  real_T x_speed;
  real_T y_speed;
  int32_T b;
  real_T leg;
  real_T tn;
  int32_T begin;
  real_T length_time;
  real_T alpha_now;
  real_T c;
  int32_T ixstart;
  int32_T ix;
  int32_T b_itmp;
  int32_T d_ixstart;
  boolean_T exitg1;
  real_T WindSpeed_mean;
  real_T loose_time;
  real_T heading;
  real_T WindAngle_ground;
  real_T sail_d_last;
  real_T heading_d_last;
  real_T jibing;
  real_T b_tacking_force_discount;
  real_T SailAngle_ground;
  real_T n;
  real_T rtb_WindAngle_mean;
  real_T rtb_speed_angle_d;
  real_T rtb_CenterPosY;
  real_T rtb_CenterPosX;
  real_T rtb_Horizontal_speed;
  real_T rtb_path[22];
  real_T rtb_jibing;
  int32_T rtb_tacking;
  int32_T rtb_sail_safe;
  real_T rtb_pos_history[300];
  int32_T i;
  real_T WindAngle_ground_0[6];
  real_T dead_sail_data[6];
  int32_T dead_sail_sizes[2];
  real_T end2_idx_0;
  real_T end2_idx_1;
  real_T start_point_idx_0;
  real_T start_point_idx_1;

  // MATLAB Function: '<Root>/MATLAB Function8' incorporates:
  //   Constant: '<Root>/Airmar_X'
  //   Constant: '<Root>/Airmar_Z'
  //   Inport: '<Root>/East'
  //   Inport: '<Root>/North'
  //   Inport: '<Root>/ahrs_Roll'
  //   Inport: '<Root>/ahrs_Yaw'

  // MATLAB Function 'MATLAB Function8': '<S9>:1'
  // X roll NED
  // '<S9>:1:3'
  // '<S9>:1:4'
  rtb_CenterPosX = (scanning_U.North - -0.61 * std::cos(scanning_U.ahrs_Yaw)) -
    0.8 * std::sin(scanning_U.ahrs_Roll) * std::cos(scanning_U.ahrs_Yaw +
    1.5707963267948966);

  // '<S9>:1:5'
  rtb_CenterPosY = (scanning_U.East - -0.61 * std::sin(scanning_U.ahrs_Yaw)) -
    0.8 * std::sin(scanning_U.ahrs_Roll) * std::sin(scanning_U.ahrs_Yaw +
    1.5707963267948966);

  // MATLAB Function: '<Root>/MATLAB Function7' incorporates:
  //   Inport: '<Root>/ahrs_Yaw'
  //   UnitDelay: '<Root>/Unit Delay14'
  //   UnitDelay: '<Root>/Unit Delay15'

  // MATLAB Function 'MATLAB Function7': '<S8>:1'
  // run period
  // '<S8>:1:6'
  memset(&rtb_pos_history[0], 0, 300U * sizeof(real_T));

  // '<S8>:1:7'
  rtb_pos_history[0] = rtb_CenterPosX;
  rtb_pos_history[100] = rtb_CenterPosY;
  rtb_pos_history[200] = scanning_U.ahrs_Yaw;

  // '<S8>:1:8'
  for (d_ixstart = 0; d_ixstart < (int32_T)(scanning_P.pos_history_len + -1.0);
       d_ixstart++) {
    // '<S8>:1:8'
    // '<S8>:1:9'
    i = (int32_T)((2.0 + (real_T)d_ixstart) - 1.0);
    rtb_pos_history[d_ixstart + 1] = scanning_DW.UnitDelay15_DSTATE[i - 1];
    rtb_pos_history[d_ixstart + 101] = scanning_DW.UnitDelay15_DSTATE[i + 99];
    rtb_pos_history[d_ixstart + 201] = scanning_DW.UnitDelay15_DSTATE[i + 199];

    // '<S8>:1:8'
  }

  // '<S8>:1:11'
  x_speed = (rtb_pos_history[0] - rtb_pos_history[(int32_T)
             scanning_P.pos_history_len - 1]) / ((scanning_P.pos_history_len -
    1.0) * 0.1);

  // '<S8>:1:12'
  y_speed = (rtb_pos_history[100] - rtb_pos_history[(int32_T)
             scanning_P.pos_history_len + 99]) / ((scanning_P.pos_history_len -
    1.0) * 0.1);

  // '<S8>:1:13'
  // '<S8>:1:14'
  // '<S8>:1:15'
  memset(&scanning_B.ship_speed_history[0], 0, 800U * sizeof(real_T));

  // '<S8>:1:16'
  scanning_B.ship_speed_history[0] = std::cos(scanning_U.ahrs_Yaw) * x_speed +
    std::sin(scanning_U.ahrs_Yaw) * y_speed;
  scanning_B.ship_speed_history[400] = -std::sin(scanning_U.ahrs_Yaw) * x_speed
    + std::cos(scanning_U.ahrs_Yaw) * y_speed;

  // '<S8>:1:17'
  for (ixstart = 0; ixstart < (int32_T)(scanning_P.ship_speed_history_len + -1.0);
       ixstart++) {
    // '<S8>:1:17'
    // '<S8>:1:18'
    i = (int32_T)((2.0 + (real_T)ixstart) - 1.0);
    scanning_B.ship_speed_history[ixstart + 1] =
      scanning_DW.UnitDelay14_DSTATE[i - 1];
    scanning_B.ship_speed_history[ixstart + 401] =
      scanning_DW.UnitDelay14_DSTATE[i + 399];

    // '<S8>:1:17'
  }

  if (1.0 > scanning_P.ship_speed_history_len) {
    b = 0;
  } else {
    b = (int32_T)scanning_P.ship_speed_history_len;
  }

  // '<S8>:1:20'
  if (b == 0) {
    x_speed = 0.0;
  } else {
    x_speed = scanning_B.ship_speed_history[0];
    for (d_ixstart = 2; d_ixstart <= b; d_ixstart++) {
      x_speed += scanning_B.ship_speed_history[d_ixstart - 1];
    }
  }

  y_speed = x_speed / (real_T)b;
  if (1.0 > scanning_P.ship_speed_history_len) {
    d_ixstart = 0;
  } else {
    d_ixstart = (int32_T)scanning_P.ship_speed_history_len;
  }

  // '<S8>:1:21'
  if (d_ixstart == 0) {
    x_speed = 0.0;
  } else {
    x_speed = scanning_B.ship_speed_history[400];
    for (ixstart = 2; ixstart <= d_ixstart; ixstart++) {
      x_speed += scanning_B.ship_speed_history[ixstart + 399];
    }
  }

  x_speed /= (real_T)d_ixstart;

  // '<S8>:1:22'
  if (std::abs(y_speed) < 0.1) {
    // '<S8>:1:23'
    // '<S8>:1:24'
    Horizontal_speed_angle = scanning_U.ahrs_Yaw;
  } else {
    // '<S8>:1:26'
    Horizontal_speed_angle = std::atan(x_speed / y_speed) + scanning_U.ahrs_Yaw;
  }

  rtb_Horizontal_speed = std::sqrt(y_speed * y_speed + x_speed * x_speed);

  // MATLAB Function: '<Root>/MATLAB Function' incorporates:
  //   UnitDelay: '<Root>/Unit Delay'

  leg = scanning_DW.UnitDelay_DSTATE;

  // MATLAB Function 'MATLAB Function': '<S1>:1'
  // '<S1>:1:3'
  // '<S1>:1:4'
  // '<S1>:1:5'
  // '<S1>:1:6'
  // '<S1>:1:7'
  x_speed = scanning_GetAngle(scanning_P.scanning_points[1] -
    scanning_P.scanning_points[3], scanning_P.scanning_points[5] -
    scanning_P.scanning_points[7]);

  // '<S1>:1:8'
  // '<S1>:1:9'
  // '<S1>:1:10'
  if ((((scanning_DW.UnitDelay_DSTATE > 3.5) && (scanning_DW.UnitDelay_DSTATE <
         4.5)) || ((scanning_DW.UnitDelay_DSTATE > 1.5) &&
                   (scanning_DW.UnitDelay_DSTATE < 2.5))) && (scanning_AngleDiff
       (x_speed, scanning_GetAngle(rtb_CenterPosX - scanning_P.scanning_points[2],
         rtb_CenterPosY - scanning_P.scanning_points[6])) < 0.0)) {
    // '<S1>:1:11'
    // '<S1>:1:12'
    leg = scanning_DW.UnitDelay_DSTATE + 1.0;
  } else if ((((scanning_DW.UnitDelay_DSTATE > 0.5) &&
               (scanning_DW.UnitDelay_DSTATE < 1.5)) ||
              ((scanning_DW.UnitDelay_DSTATE > 2.5) &&
               (scanning_DW.UnitDelay_DSTATE < 3.5)) ||
              ((scanning_DW.UnitDelay_DSTATE > 4.5) &&
               (scanning_DW.UnitDelay_DSTATE < 5.5)) ||
              ((scanning_DW.UnitDelay_DSTATE > 6.5) &&
               (scanning_DW.UnitDelay_DSTATE < 7.5))) && (scanning_AngleDiff
              (x_speed, scanning_GetAngle(rtb_CenterPosX -
                scanning_P.scanning_points[3], rtb_CenterPosY -
                scanning_P.scanning_points[7])) > 0.0)) {
    // '<S1>:1:14'
    // '<S1>:1:15'
    leg = scanning_DW.UnitDelay_DSTATE + 1.0;
  } else {
    if ((scanning_DW.UnitDelay_DSTATE > 5.5) && (scanning_DW.UnitDelay_DSTATE <
         6.5) && (scanning_AngleDiff(x_speed, scanning_GetAngle(rtb_CenterPosX -
           (scanning_P.scanning_points[2] + scanning_P.scanning_points[3]) / 2.0,
           rtb_CenterPosY - (scanning_P.scanning_points[6] +
            scanning_P.scanning_points[7]) / 2.0)) < 0.0)) {
      // '<S1>:1:17'
      // '<S1>:1:18'
      leg = scanning_DW.UnitDelay_DSTATE + 1.0;
    }
  }

  // '<S1>:1:21'
  x_speed = ((8.5 - leg) * scanning_P.scanning_points[0] + (leg - 0.5) *
             scanning_P.scanning_points[2]) / 8.0;
  y_speed = ((8.5 - leg) * scanning_P.scanning_points[4] + (leg - 0.5) *
             scanning_P.scanning_points[6]) / 8.0;

  // '<S1>:1:22'
  end2_idx_0 = ((8.5 - leg) * scanning_P.scanning_points[1] + (leg - 0.5) *
                scanning_P.scanning_points[3]) / 8.0;
  end2_idx_1 = ((8.5 - leg) * scanning_P.scanning_points[5] + (leg - 0.5) *
                scanning_P.scanning_points[7]) / 8.0;
  if ((rt_roundd_snf(leg - std::floor(leg / 2.0) * 2.0) > 0.5) && (leg < 4.5)) {
    // '<S1>:1:23'
    // '<S1>:1:24'
    start_point_idx_0 = x_speed;
    start_point_idx_1 = y_speed;

    // '<S1>:1:25'
    x_speed = end2_idx_0;
    y_speed = end2_idx_1;
  } else if ((rt_roundd_snf(leg - std::floor(leg / 2.0) * 2.0) < 0.5) && (leg <
              4.5)) {
    // '<S1>:1:26'
    // '<S1>:1:27'
    start_point_idx_0 = end2_idx_0;
    start_point_idx_1 = end2_idx_1;

    // '<S1>:1:28'
  } else if ((rt_roundd_snf(leg - std::floor(leg / 2.0) * 2.0) > 0.5) && (leg >
              4.5)) {
    // '<S1>:1:29'
    // '<S1>:1:30'
    start_point_idx_0 = (x_speed + end2_idx_0) / 2.0;
    start_point_idx_1 = (y_speed + end2_idx_1) / 2.0;

    // '<S1>:1:31'
    x_speed = end2_idx_0;
    y_speed = end2_idx_1;
  } else if ((rt_roundd_snf(leg - std::floor(leg / 2.0) * 2.0) < 0.5) && (leg >
              4.5) && (leg < 7.5)) {
    // '<S1>:1:32'
    // '<S1>:1:33'
    start_point_idx_0 = end2_idx_0;
    start_point_idx_1 = end2_idx_1;

    // '<S1>:1:34'
    x_speed = (x_speed + end2_idx_0) / 2.0;
    y_speed = (y_speed + end2_idx_1) / 2.0;
  } else {
    // '<S1>:1:36'
    start_point_idx_0 = end2_idx_0;
    start_point_idx_1 = end2_idx_1;

    // '<S1>:1:37'
  }

  // '<S1>:1:40'
  // '<S1>:1:41'
  for (d_ixstart = 0; d_ixstart < 11; d_ixstart++) {
    // '<S1>:1:41'
    // '<S1>:1:42'
    rtb_path[d_ixstart] = ((11.0 - (1.0 + (real_T)d_ixstart)) *
      start_point_idx_0 + ((1.0 + (real_T)d_ixstart) - 1.0) * x_speed) / 10.0;

    // '<S1>:1:43'
    rtb_path[11 + d_ixstart] = ((11.0 - (1.0 + (real_T)d_ixstart)) *
      start_point_idx_1 + ((1.0 + (real_T)d_ixstart) - 1.0) * y_speed) / 10.0;

    // '<S1>:1:41'
  }

  // MATLAB Function: '<Root>/MATLAB Function3' incorporates:
  //   UnitDelay: '<Root>/Unit Delay1'
  //   UnitDelay: '<Root>/Unit Delay2'
  //   UnitDelay: '<Root>/Unit Delay3'
  //   UnitDelay: '<Root>/Unit Delay4'

  // '<S1>:1:45'
  // '<S1>:1:46'
  alpha_now = scanning_DW.UnitDelay4_DSTATE;
  x_speed = scanning_DW.UnitDelay1_DSTATE;

  // MATLAB Function 'MATLAB Function3': '<S4>:1'
  // '<S4>:1:3'
  // '<S4>:1:4'
  // '<S4>:1:6'
  begin = 0;

  // '<S4>:1:7'
  // time from point to point
  // '<S4>:1:8'
  // run period
  // '<S4>:1:9'
  // 2*50run period
  if ((scanning_DW.UnitDelay2_DSTATE != rtb_path[0]) ||
      (scanning_DW.UnitDelay3_DSTATE != rtb_path[11])) {
    // '<S4>:1:11'
    // 
    // '<S4>:1:12'
    x_speed = 0.1;

    // '<S4>:1:13'
    b = 1;
  } else {
    // '<S4>:1:15'
    b = 0;
  }

  // Update for UnitDelay: '<Root>/Unit Delay1' incorporates:
  //   MATLAB Function: '<Root>/MATLAB Function3'

  // '<S4>:1:17'
  // '<S4>:1:18'
  // '<S4>:1:19'
  scanning_DW.UnitDelay1_DSTATE = x_speed + 0.1;

  // MATLAB Function: '<Root>/MATLAB Function3'
  // 
  // '<S4>:1:21'
  // '<S4>:1:26'
  x_speed /= 0.1;

  // '<S4>:1:27'
  y_speed = std::floor(x_speed);
  if (y_speed <= 1.0) {
    // '<S4>:1:28'
    // '<S4>:1:29'
    y_speed = 1.0;
  }

  // '<S4>:1:31'
  if (y_speed > 10.0) {
    // '<S4>:1:32'
    // '<S4>:1:34'
    x_speed = (x_speed - y_speed) + 10.0;
  }

  if (x_speed == 1.0) {
    // '<S4>:1:36'
    // '<S4>:1:37'
    alpha_now = 1.0;
  }

  //  find the nearest setpoint
  // '<S4>:1:43'
  for (i = 0; i < 1000; i++) {
    scanning_B.Dis[i] = (rtInf);
  }

  if (alpha_now + 50.0 >= 10.0) {
    // '<S4>:1:45'
    if (alpha_now > 50.0) {
      // '<S4>:1:46'
      // '<S4>:1:47'
      for (ixstart = 0; ixstart < (int32_T)((51.0 - alpha_now) + 10.0); ixstart
           ++) {
        // '<S4>:1:47'
        // '<S4>:1:48'
        x_speed = rtb_path[(int32_T)((((1.0 + (real_T)ixstart) + alpha_now) -
          50.0) - 1.0) - 1] - rtb_CenterPosX;
        y_speed = rtb_path[(int32_T)((((1.0 + (real_T)ixstart) + alpha_now) -
          50.0) - 1.0) + 10] - rtb_CenterPosY;
        scanning_B.Dis[ixstart] = std::sqrt(x_speed * x_speed + y_speed *
          y_speed);

        // '<S4>:1:47'
      }

      d_ixstart = 1;
      x_speed = scanning_B.Dis[0];
      ixstart = 1;
      if (rtIsNaN(scanning_B.Dis[0])) {
        i = 2;
        exitg1 = false;
        while ((!exitg1) && (i < 1001)) {
          d_ixstart = i;
          if (!rtIsNaN(scanning_B.Dis[i - 1])) {
            x_speed = scanning_B.Dis[i - 1];
            ixstart = i;
            exitg1 = true;
          } else {
            i++;
          }
        }
      }

      if (d_ixstart < 1000) {
        while (d_ixstart + 1 < 1001) {
          if (scanning_B.Dis[d_ixstart] < x_speed) {
            x_speed = scanning_B.Dis[d_ixstart];
            ixstart = d_ixstart + 1;
          }

          d_ixstart++;
        }
      }

      // '<S4>:1:50'
      // '<S4>:1:51'
      tn = (((real_T)ixstart + alpha_now) - 50.0) - 1.0;
    } else {
      // '<S4>:1:53'
      for (ixstart = 0; ixstart < 10; ixstart++) {
        // '<S4>:1:53'
        // '<S4>:1:54'
        x_speed = rtb_path[ixstart] - rtb_CenterPosX;
        y_speed = rtb_path[11 + ixstart] - rtb_CenterPosY;
        scanning_B.Dis[ixstart] = std::sqrt(x_speed * x_speed + y_speed *
          y_speed);

        // '<S4>:1:53'
      }

      ixstart = 1;
      x_speed = scanning_B.Dis[0];
      i = 1;
      if (rtIsNaN(scanning_B.Dis[0])) {
        ix = 2;
        exitg1 = false;
        while ((!exitg1) && (ix < 1001)) {
          ixstart = ix;
          if (!rtIsNaN(scanning_B.Dis[ix - 1])) {
            x_speed = scanning_B.Dis[ix - 1];
            i = ix;
            exitg1 = true;
          } else {
            ix++;
          }
        }
      }

      if (ixstart < 1000) {
        while (ixstart + 1 < 1001) {
          if (scanning_B.Dis[ixstart] < x_speed) {
            x_speed = scanning_B.Dis[ixstart];
            i = ixstart + 1;
          }

          ixstart++;
        }
      }

      // '<S4>:1:56'
      tn = i;

      // (1:Dislen)
    }
  } else if (alpha_now > 50.0) {
    // '<S4>:1:59'
    // '<S4>:1:60'
    for (ixstart = 0; ixstart < 101; ixstart++) {
      // '<S4>:1:60'
      // '<S4>:1:61'
      x_speed = rtb_path[(int32_T)((((1.0 + (real_T)ixstart) + alpha_now) - 50.0)
        - 1.0) - 1] - rtb_CenterPosX;
      y_speed = rtb_path[(int32_T)((((1.0 + (real_T)ixstart) + alpha_now) - 50.0)
        - 1.0) + 10] - rtb_CenterPosY;
      scanning_B.Dis[ixstart] = std::sqrt(x_speed * x_speed + y_speed * y_speed);

      // '<S4>:1:60'
    }

    ixstart = 1;
    x_speed = scanning_B.Dis[0];
    b_itmp = 1;
    if (rtIsNaN(scanning_B.Dis[0])) {
      i = 2;
      exitg1 = false;
      while ((!exitg1) && (i < 1001)) {
        ixstart = i;
        if (!rtIsNaN(scanning_B.Dis[i - 1])) {
          x_speed = scanning_B.Dis[i - 1];
          b_itmp = i;
          exitg1 = true;
        } else {
          i++;
        }
      }
    }

    if (ixstart < 1000) {
      while (ixstart + 1 < 1001) {
        if (scanning_B.Dis[ixstart] < x_speed) {
          x_speed = scanning_B.Dis[ixstart];
          b_itmp = ixstart + 1;
        }

        ixstart++;
      }
    }

    // '<S4>:1:63'
    // '<S4>:1:64'
    tn = (((real_T)b_itmp + alpha_now) - 50.0) - 1.0;
  } else {
    // '<S4>:1:66'
    for (ixstart = 0; ixstart < (int32_T)(alpha_now + 50.0); ixstart++) {
      // '<S4>:1:66'
      // '<S4>:1:67'
      x_speed = rtb_path[ixstart] - rtb_CenterPosX;
      y_speed = rtb_path[11 + ixstart] - rtb_CenterPosY;
      scanning_B.Dis[ixstart] = std::sqrt(x_speed * x_speed + y_speed * y_speed);

      // '<S4>:1:66'
    }

    ixstart = 1;
    x_speed = scanning_B.Dis[0];
    i = 1;
    if (rtIsNaN(scanning_B.Dis[0])) {
      ix = 2;
      exitg1 = false;
      while ((!exitg1) && (ix < 1001)) {
        ixstart = ix;
        if (!rtIsNaN(scanning_B.Dis[ix - 1])) {
          x_speed = scanning_B.Dis[ix - 1];
          i = ix;
          exitg1 = true;
        } else {
          ix++;
        }
      }
    }

    if (ixstart < 1000) {
      while (ixstart + 1 < 1001) {
        if (scanning_B.Dis[ixstart] < x_speed) {
          x_speed = scanning_B.Dis[ixstart];
          i = ixstart + 1;
        }

        ixstart++;
      }
    }

    // '<S4>:1:69'
    tn = i;
  }

  // tn
  // LOS algorithm
  if (tn > 10.0) {
    // '<S4>:1:77'
    // '<S4>:1:78'
    tn = 10.0;
  }

  if (tn <= 1.0) {
    // '<S4>:1:80'
    // '<S4>:1:81'
    tn = 2.0;

    // '<S4>:1:82'
    begin = 1;
  }

  if (x_speed == 0.0) {
    // '<S4>:1:84'
    // '<S4>:1:85'
    ixstart = 1;
  } else {
    // '<S4>:1:87'
    x_speed = scanning_GetAngle_n(rtb_path[(int32_T)tn - 1] - rtb_path[(int32_T)
                                  (tn - 1.0) - 1], rtb_path[(int32_T)tn + 10] -
      rtb_path[(int32_T)(tn - 1.0) + 10]);

    // '<S4>:1:88'
    y_speed = scanning_GetAngle_n(rtb_path[(int32_T)(tn + 1.0) - 1] - rtb_path
      [(int32_T)tn - 1], rtb_path[(int32_T)(tn + 1.0) + 10] - rtb_path[(int32_T)
      tn + 10]);
    if (x_speed - y_speed > 3.1415926535897931) {
      // '<S4>:1:89'
      // '<S4>:1:90'
      x_speed -= 6.2831853071795862;
    } else {
      if (y_speed - x_speed > 3.1415926535897931) {
        // '<S4>:1:91'
        // '<S4>:1:92'
        y_speed -= 6.2831853071795862;
      }
    }

    // '<S4>:1:94'
    alpha_now = scanning_GetAngle_n(rtb_CenterPosX - rtb_path[(int32_T)tn - 1],
      rtb_CenterPosY - rtb_path[(int32_T)tn + 10]);

    // '<S4>:1:95'
    end2_idx_0 = std::abs(scanning_AngleDiff_b(y_speed, x_speed));

    // '<S4>:1:96'
    x_speed = (x_speed + y_speed) / 2.0;
    if (std::abs(scanning_AngleDiff_b(x_speed, alpha_now)) < 1.5707963267948966
        - end2_idx_0 / 2.0) {
      // '<S4>:1:98'
      // '<S4>:1:99'
      ixstart = 2;
    } else if ((std::abs(scanning_AngleDiff_b(x_speed, alpha_now)) >=
                1.5707963267948966 - end2_idx_0 / 2.0) && (std::abs
                (scanning_AngleDiff_b(x_speed, alpha_now)) <= end2_idx_0 / 2.0 +
                1.5707963267948966)) {
      // '<S4>:1:100'
      // '<S4>:1:101'
      ixstart = 1;
    } else {
      // if abs(alpha_now-alpha_edge)>(pi/2+angle_area/2)
      // '<S4>:1:103'
      ixstart = 0;
    }
  }

  if (ixstart == 0) {
    // '<S4>:1:111'
    // '<S4>:1:112'
    tn--;
  }

  // '<S4>:1:114'
  // '<S4>:1:115'
  // '<S4>:1:116'
  // '<S4>:1:117'
  // '<S4>:1:120'
  x_speed = rtb_path[(int32_T)tn + 10] - rtb_path[(int32_T)(tn + 1.0) + 10];
  y_speed = rtb_path[(int32_T)(tn + 1.0) - 1] - rtb_path[(int32_T)tn - 1];
  end2_idx_0 = std::abs((((rtb_path[(int32_T)tn + 10] - rtb_path[(int32_T)(tn +
    1.0) + 10]) * rtb_CenterPosX + (rtb_path[(int32_T)(tn + 1.0) - 1] -
    rtb_path[(int32_T)tn - 1]) * rtb_CenterPosY) - rtb_path[(int32_T)(tn + 1.0)
    - 1] * rtb_path[(int32_T)tn + 10]) + rtb_path[(int32_T)(tn + 1.0) + 10] *
                        rtb_path[(int32_T)tn - 1]) / std::sqrt(x_speed * x_speed
    + y_speed * y_speed);

  // '<S4>:1:121'
  x_speed = rtb_path[(int32_T)tn + 10] - rtb_CenterPosY;
  y_speed = rtb_path[(int32_T)tn - 1] - rtb_CenterPosX;
  alpha_now = std::sqrt(x_speed * x_speed + y_speed * y_speed);

  // '<S4>:1:122'
  x_speed = rtb_path[(int32_T)(tn + 1.0) + 10] - rtb_CenterPosY;
  y_speed = rtb_path[(int32_T)(tn + 1.0) - 1] - rtb_CenterPosX;
  x_speed = std::sqrt(x_speed * x_speed + y_speed * y_speed);
  if (ixstart == 1) {
    // '<S4>:1:125'
    // '<S4>:1:127'
    x_speed = rtb_path[(int32_T)tn - 1] - rtb_path[(int32_T)(tn + 1.0) - 1];
    y_speed = rtb_path[(int32_T)tn + 10] - rtb_path[(int32_T)(tn + 1.0) + 10];
    alpha_now = std::sqrt(x_speed * x_speed + y_speed * y_speed);

    // '<S4>:1:128'
    end2_idx_1 = rtb_path[(int32_T)tn - 1];

    // '<S4>:1:129'
    x_speed = rtb_path[(int32_T)tn + 10];
  } else {
    if (end2_idx_0 > alpha_now) {
      // '<S4>:1:131'
      // '<S4>:1:132'
      end2_idx_0 = alpha_now;
    }

    if (end2_idx_0 > x_speed) {
      // '<S4>:1:134'
      // '<S4>:1:135'
      end2_idx_0 = x_speed;
    }

    // '<S4>:1:137'
    y_speed = std::sqrt(alpha_now * alpha_now - end2_idx_0 * end2_idx_0);

    // '<S4>:1:138'
    alpha_now = std::sqrt(x_speed * x_speed - end2_idx_0 * end2_idx_0);

    // '<S4>:1:139'
    end2_idx_1 = alpha_now / (y_speed + alpha_now) * rtb_path[(int32_T)tn - 1] +
      y_speed / (y_speed + alpha_now) * rtb_path[(int32_T)(tn + 1.0) - 1];

    // '<S4>:1:140'
    x_speed = alpha_now / (y_speed + alpha_now) * rtb_path[(int32_T)tn + 10] +
      y_speed / (y_speed + alpha_now) * rtb_path[(int32_T)(tn + 1.0) + 10];
  }

  if (begin == 1) {
    // '<S4>:1:143'
    // '<S4>:1:144'
    end2_idx_1 = rtb_path[1];

    // '<S4>:1:145'
    x_speed = rtb_path[12];
  }

  // sn_x,sn_y)
  // R=100+L/5;
  if (!(scanning_P.R <= end2_idx_0)) {
    // '<S4>:1:157'
    start_point_idx_0 = std::sqrt(scanning_P.R * scanning_P.R - end2_idx_0 *
      end2_idx_0);
    if (start_point_idx_0 <= alpha_now) {
      // '<S4>:1:158'
      // '<S4>:1:159'
      end2_idx_1 += (rtb_path[(int32_T)(tn + 1.0) - 1] - end2_idx_1) *
        (start_point_idx_0 / alpha_now);

      // '<S4>:1:160'
      x_speed += (rtb_path[(int32_T)(tn + 1.0) + 10] - x_speed) *
        (start_point_idx_0 / alpha_now);
    } else {
      // '<S4>:1:162'
      start_point_idx_1 = tn;

      // '<S4>:1:163'
      start_point_idx_0 -= alpha_now;

      //              while GetDistance(x_set(i),y_set(i),x_set(i+1),y_set(i+1))==0 
      //                  i=i+1;
      //              end
      while ((start_point_idx_0 >= 0.0) && (start_point_idx_1 < 10.0)) {
        // '<S4>:1:167'
        // '<S4>:1:168'
        start_point_idx_1++;

        // '<S4>:1:169'
        x_speed = rtb_path[(int32_T)start_point_idx_1 - 1] - rtb_path[(int32_T)
          (start_point_idx_1 + 1.0) - 1];
        y_speed = rtb_path[(int32_T)start_point_idx_1 + 10] - rtb_path[(int32_T)
          (start_point_idx_1 + 1.0) + 10];
        start_point_idx_0 -= std::sqrt(x_speed * x_speed + y_speed * y_speed);
      }

      if (start_point_idx_1 >= 10.0) {
        // '<S4>:1:171'
        // '<S4>:1:172'
        end2_idx_1 = rtb_path[10];

        // '<S4>:1:173'
        x_speed = rtb_path[21];
      } else {
        // '<S4>:1:175'
        x_speed = rtb_path[(int32_T)(start_point_idx_1 + 1.0) - 1] - rtb_path
          [(int32_T)start_point_idx_1 - 1];
        y_speed = rtb_path[(int32_T)(start_point_idx_1 + 1.0) + 10] - rtb_path
          [(int32_T)start_point_idx_1 + 10];
        alpha_now = rtb_path[(int32_T)(start_point_idx_1 + 1.0) - 1] - rtb_path
          [(int32_T)start_point_idx_1 - 1];
        end2_idx_0 = rtb_path[(int32_T)(start_point_idx_1 + 1.0) + 10] -
          rtb_path[(int32_T)start_point_idx_1 + 10];
        end2_idx_1 = (std::sqrt(x_speed * x_speed + y_speed * y_speed) +
                      start_point_idx_0) / std::sqrt(alpha_now * alpha_now +
          end2_idx_0 * end2_idx_0) * (rtb_path[(int32_T)(start_point_idx_1 + 1.0)
          - 1] - rtb_path[(int32_T)start_point_idx_1 - 1]) + rtb_path[(int32_T)
          start_point_idx_1 - 1];

        // '<S4>:1:176'
        x_speed = rtb_path[(int32_T)(start_point_idx_1 + 1.0) - 1] - rtb_path
          [(int32_T)start_point_idx_1 - 1];
        y_speed = rtb_path[(int32_T)(start_point_idx_1 + 1.0) + 10] - rtb_path
          [(int32_T)start_point_idx_1 + 10];
        alpha_now = rtb_path[(int32_T)(start_point_idx_1 + 1.0) - 1] - rtb_path
          [(int32_T)start_point_idx_1 - 1];
        end2_idx_0 = rtb_path[(int32_T)(start_point_idx_1 + 1.0) + 10] -
          rtb_path[(int32_T)start_point_idx_1 + 10];
        x_speed = (std::sqrt(x_speed * x_speed + y_speed * y_speed) +
                   start_point_idx_0) / std::sqrt(alpha_now * alpha_now +
          end2_idx_0 * end2_idx_0) * (rtb_path[(int32_T)(start_point_idx_1 + 1.0)
          + 10] - rtb_path[(int32_T)start_point_idx_1 + 10]) + rtb_path[(int32_T)
          start_point_idx_1 + 10];
      }
    }
  } else {
    // '<S4>:1:153'
    // '<S4>:1:154'
    // '<S4>:1:155'
  }

  // '<S4>:1:182'
  // Heading_d=speed_angle_d-drift_angle;
  rtb_speed_angle_d = scanning_GetAngle_n(end2_idx_1 - rtb_CenterPosX, x_speed -
    rtb_CenterPosY);

  // MATLAB Function: '<Root>/MATLAB Function6' incorporates:
  //   Constant: '<Root>/Airmar_X'
  //   Constant: '<Root>/Airmar_Z'
  //   Inport: '<Root>/Airmar_wind_angle'
  //   Inport: '<Root>/Airmar_wind_speed'
  //   Inport: '<Root>/ahrs_Roll'
  //   Inport: '<Root>/ahrs_Roll_rate'
  //   Inport: '<Root>/ahrs_Yaw'
  //   Inport: '<Root>/ahrs_Yaw_rate'
  //   MATLAB Function: '<Root>/MATLAB Function7'
  //   UnitDelay: '<Root>/Unit Delay13'

  // MATLAB Function 'MATLAB Function6': '<S7>:1'
  // '<S7>:1:4'
  // '<S7>:1:5'
  // '<S7>:1:6'
  end2_idx_1 = std::cos(scanning_U.Airmar_wind_angle + scanning_U.ahrs_Yaw) *
    scanning_U.Airmar_wind_speed - ((std::cos(scanning_U.ahrs_Yaw +
    1.5707963267948966) * scanning_U.ahrs_Roll_rate * 0.8 + rtb_Horizontal_speed
    * std::cos(Horizontal_speed_angle)) + std::cos(scanning_U.ahrs_Yaw +
    1.5707963267948966) * scanning_U.ahrs_Yaw_rate * -0.61);

  // %%%%%%%%%%%%%%%%%%%%%%%%%%
  // '<S7>:1:7'
  start_point_idx_0 = std::sin(scanning_U.Airmar_wind_angle +
    scanning_U.ahrs_Yaw) * scanning_U.Airmar_wind_speed - ((std::sin
    (scanning_U.ahrs_Yaw + 1.5707963267948966) * scanning_U.ahrs_Roll_rate * 0.8
    + rtb_Horizontal_speed * std::sin(Horizontal_speed_angle)) + std::sin
    (scanning_U.ahrs_Yaw + 1.5707963267948966) * scanning_U.ahrs_Yaw_rate *
    -0.61);

  // %%%%%%%%%%%%%%%%%%%%%%%%%%
  // '<S7>:1:9'
  if ((std::abs(scanning_U.ahrs_Roll) < 0.78539816339744828) && (std::abs
       (scanning_U.ahrs_Roll_rate) < 1.0471975511965976)) {
    // '<S7>:1:12'
    // '<S7>:1:13'
    d_ixstart = 1;
  } else {
    // '<S7>:1:15'
    d_ixstart = 0;
  }

  // '<S7>:1:17'
  memset(&scanning_B.real_wind_history[0], 0, 6000U * sizeof(real_T));

  // '<S7>:1:18'
  scanning_B.real_wind_history[0] = end2_idx_1;
  scanning_B.real_wind_history[2000] = start_point_idx_0;
  scanning_B.real_wind_history[4000] = d_ixstart;

  // '<S7>:1:20'
  alpha_now = rt_roundd_snf(scanning_P.wind_mean_time / 0.1);

  // '<S7>:1:20'
  for (d_ixstart = 0; d_ixstart < (int32_T)(alpha_now + -1.0); d_ixstart++) {
    // '<S7>:1:20'
    // '<S7>:1:21'
    i = (int32_T)((2.0 + (real_T)d_ixstart) - 1.0);
    scanning_B.real_wind_history[d_ixstart + 1] =
      scanning_DW.UnitDelay13_DSTATE[i - 1];
    scanning_B.real_wind_history[d_ixstart + 2001] =
      scanning_DW.UnitDelay13_DSTATE[i + 1999];
    scanning_B.real_wind_history[d_ixstart + 4001] =
      scanning_DW.UnitDelay13_DSTATE[i + 3999];

    // '<S7>:1:20'
  }

  // '<S7>:1:24'
  x_speed = 0.0;

  // '<S7>:1:25'
  y_speed = 0.0;

  // '<S7>:1:26'
  alpha_now = 0.0;

  // '<S7>:1:27'
  end2_idx_0 = 0.0;

  // '<S7>:1:28'
  c = rt_roundd_snf(scanning_P.wind_mean_time / 0.1);

  // '<S7>:1:28'
  for (ixstart = 0; ixstart < (int32_T)c; ixstart++) {
    // '<S7>:1:28'
    if (scanning_B.real_wind_history[4000 + ixstart] > 0.5) {
      // '<S7>:1:29'
      // '<S7>:1:30'
      x_speed += scanning_B.real_wind_history[ixstart];

      // '<S7>:1:31'
      y_speed += scanning_B.real_wind_history[2000 + ixstart];

      // '<S7>:1:32'
      alpha_now += std::sqrt(scanning_B.real_wind_history[2000 + ixstart] *
        scanning_B.real_wind_history[2000 + ixstart] +
        scanning_B.real_wind_history[ixstart] *
        scanning_B.real_wind_history[ixstart]);

      // '<S7>:1:33'
      end2_idx_0++;
    }

    // '<S7>:1:28'
  }

  if (end2_idx_0 < 0.5) {
    // '<S7>:1:36'
    // '<S7>:1:37'
    // '<S7>:1:38'
    // '<S7>:1:39'
    WindSpeed_mean = std::sqrt(end2_idx_1 * end2_idx_1 + start_point_idx_0 *
      start_point_idx_0);
  } else {
    // '<S7>:1:41'
    end2_idx_1 = x_speed / end2_idx_0;

    // '<S7>:1:42'
    start_point_idx_0 = y_speed / end2_idx_0;

    // '<S7>:1:43'
    WindSpeed_mean = alpha_now / end2_idx_0;
  }

  if (std::abs(end2_idx_1) < 1.0E-5) {
    // '<S7>:1:45'
    // '<S7>:1:46'
    end2_idx_1 = 1.0E-5;
  }

  // '<S7>:1:48'
  rtb_WindAngle_mean = std::atan(start_point_idx_0 / end2_idx_1);

  // MATLAB Function: '<Root>/MATLAB Function4' incorporates:
  //   MATLAB Function: '<Root>/MATLAB Function3'
  //   UnitDelay: '<Root>/Unit Delay9'

  // MATLAB Function 'MATLAB Function4': '<S5>:1'
  if (scanning_DW.UnitDelay9_DSTATE > scanning_P.jibing_time) {
    // '<S5>:1:3'
    // '<S5>:1:4'
    rtb_jibing = 1.0;
  } else {
    // '<S5>:1:6'
    rtb_jibing = scanning_DW.UnitDelay9_DSTATE + 1.0;
  }

  // '<S5>:1:13'
  rtb_tacking = 2;
  if (b > 0.5) {
    // '<S5>:1:14'
    // '<S5>:1:15'
    rtb_jibing = 1.0;

    // '<S5>:1:16'
    rtb_tacking = 1;
  }

  // End of MATLAB Function: '<Root>/MATLAB Function4'

  // MATLAB Function: '<Root>/MATLAB Function5' incorporates:
  //   Inport: '<Root>/ahrs_Roll'
  //   UnitDelay: '<Root>/Unit Delay11'

  // MATLAB Function 'MATLAB Function5': '<S6>:1'
  if (std::abs(scanning_U.ahrs_Roll) > scanning_P.max_roll_allowed) {
    // '<S6>:1:2'
    // '<S6>:1:3'
    loose_time = scanning_P.max_loose_time;
  } else {
    // '<S6>:1:5'
    loose_time = scanning_DW.UnitDelay11_DSTATE - 1.0;
  }

  if (loose_time < 0.0) {
    // '<S6>:1:7'
    // '<S6>:1:8'
    rtb_sail_safe = 1;
  } else {
    // '<S6>:1:10'
    rtb_sail_safe = 0;
  }

  // MATLAB Function: '<Root>/MATLAB Function1' incorporates:
  //   Inport: '<Root>/ahrs_Yaw'
  //   MATLAB Function: '<Root>/MATLAB Function6'
  //   MATLAB Function: '<Root>/MATLAB Function7'
  //   UnitDelay: '<Root>/Unit Delay7'
  //   UnitDelay: '<Root>/Unit Delay8'
  //   UnitDelay: '<Root>/Unit Delay9'

  heading = scanning_U.ahrs_Yaw;
  sail_d_last = scanning_DW.UnitDelay7_DSTATE;
  heading_d_last = scanning_DW.UnitDelay8_DSTATE;
  jibing = scanning_DW.UnitDelay9_DSTATE;
  b_tacking_force_discount = scanning_P.tacking_force_discount;

  // MATLAB Function 'MATLAB Function1': '<S2>:1'
  // yaw,yaw_rate,,attack_angle
  // jibing
  // SailAngle_groundsail_d
  // '<S2>:1:4'
  y_speed = WindSpeed_mean * std::cos(rtb_WindAngle_mean) + rtb_Horizontal_speed
    * std::cos(Horizontal_speed_angle);

  // '<S2>:1:5'
  x_speed = WindSpeed_mean * std::sin(rtb_WindAngle_mean) + rtb_Horizontal_speed
    * std::sin(Horizontal_speed_angle);

  // '<S2>:1:6'
  WindAngle_ground = std::atan(x_speed / y_speed);

  // '<S2>:1:7'
  rtb_CenterPosX = std::sqrt(y_speed * y_speed + x_speed * x_speed);

  // '<S2>:1:10'
  rtb_CenterPosY = ((rt_roundd_snf(WindAngle_ground / 3.1415926535897931 * 180.0)
                     + 90.0) - (rt_roundd_snf(WindAngle_ground /
    3.1415926535897931 * 180.0) - 90.0)) + 1.0;

  // '<S2>:1:11'
  // '<S2>:1:12'
  for (i = 0; i < 760; i++) {
    scanning_B.SailForce_ground[i] = 0.0;
    scanning_B.price[i] = 0.0;
  }

  // '<S2>:1:13'
  rtb_Horizontal_speed = rt_roundd_snf(WindAngle_ground / 3.1415926535897931 *
    180.0);

  // '<S2>:1:13'
  b = (int32_T)((rt_roundd_snf(WindAngle_ground / 3.1415926535897931 * 180.0) +
                 90.0) + (1.0 - (rtb_Horizontal_speed - 90.0)));

  // '<S2>:1:13'
  for (begin = 0; begin < b; begin++) {
    // '<S2>:1:13'
    SailAngle_ground = (rtb_Horizontal_speed - 90.0) + (real_T)begin;

    // '<S2>:1:14'
    n = (SailAngle_ground - (rt_roundd_snf(WindAngle_ground / 3.1415926535897931
           * 180.0) - 90.0)) + 1.0;
    scanning_getSailForce_ground(WindAngle_ground, SailAngle_ground / 180.0 *
      3.1415926535897931, rtb_CenterPosX, &start_point_idx_0, &length_time,
      &x_speed);

    // '<S2>:1:17'
    scanning_B.SailForce_ground[(int32_T)n - 1] = SailAngle_ground;

    // '<S2>:1:18'
    scanning_B.SailForce_ground[(int32_T)n + 189] = start_point_idx_0;

    // '<S2>:1:19'
    scanning_B.SailForce_ground[(int32_T)n + 379] = length_time;

    // '<S2>:1:20'
    scanning_B.SailForce_ground[(int32_T)n + 569] = x_speed;

    // '<S2>:1:25'
    end2_idx_0 = (rt_roundd_snf((length_time + 1.3089969389957472) /
      3.1415926535897931 * 180.0) - rt_roundd_snf((length_time -
      1.3089969389957472) / 3.1415926535897931 * 180.0)) + 1.0;

    // '<S2>:1:26'
    memset(&scanning_B.price_fixSail[0], 0, 1140U * sizeof(real_T));

    // '<S2>:1:27'
    c = rt_roundd_snf((length_time - 1.3089969389957472) / 3.1415926535897931 *
                      180.0);

    // '<S2>:1:27'
    d_ixstart = (int32_T)(rt_roundd_snf((length_time + 1.3089969389957472) /
      3.1415926535897931 * 180.0) + (1.0 - c));

    // '<S2>:1:27'
    for (ixstart = 0; ixstart < d_ixstart; ixstart++) {
      // '<S2>:1:27'
      start_point_idx_1 = c + (real_T)ixstart;

      // '<S2>:1:30'
      end2_idx_1 = (start_point_idx_1 - rt_roundd_snf((length_time -
        1.3089969389957472) / 3.1415926535897931 * 180.0)) + 1.0;

      // '<S2>:1:31'
      x_speed = start_point_idx_1 / 180.0 * 3.1415926535897931;

      // '<S2>:1:32'
      y_speed = scanning_HeadingDeadZone(x_speed, WindAngle_ground,
        SailAngle_ground / 180.0 * 3.1415926535897931, (real_T)rtb_tacking,
        heading_d_last / 3.1415926535897931 * 180.0);

      // speed_angle=heading_check+AngleDiff(heading_check,SailForceAngle_ground)/5;%%%, 
      // '<S2>:1:34'
      alpha_now = scanning_AngleDiff_f(rtb_speed_angle_d, x_speed);
      if ((y_speed > 0.5) && (y_speed < 1.5)) {
        // '<S2>:1:36'
        // '<S2>:1:37'
        alpha_now = 100.0;

        // 10000;
      }

      // %%%
      // '<S2>:1:41'
      scanning_B.price_fixSail[(int32_T)end2_idx_1 - 1] = x_speed;

      // '<S2>:1:42'
      scanning_B.price_fixSail[(int32_T)end2_idx_1 + 189] = alpha_now;

      // '<S2>:1:43'
      scanning_B.price_fixSail[(int32_T)end2_idx_1 + 379] = length_time;

      // '<S2>:1:44'
      scanning_B.price_fixSail[(int32_T)end2_idx_1 + 569] = y_speed;
      if (alpha_now < 0.0) {
        // '<S2>:1:45'
        // '<S2>:1:46'
        scanning_B.price_fixSail[(int32_T)end2_idx_1 + 759] = 100.0;
      } else {
        // '<S2>:1:48'
        scanning_B.price_fixSail[(int32_T)end2_idx_1 + 759] = alpha_now;
      }

      if (alpha_now > 0.0) {
        // '<S2>:1:50'
        // '<S2>:1:51'
        scanning_B.price_fixSail[(int32_T)end2_idx_1 + 949] = -100.0;
      } else {
        // '<S2>:1:53'
        scanning_B.price_fixSail[(int32_T)end2_idx_1 + 949] = alpha_now;
      }

      // '<S2>:1:27'
    }

    // %%%
    // 
    if (1.0 > end2_idx_0) {
      d_ixstart = 0;
    } else {
      d_ixstart = (int32_T)end2_idx_0;
    }

    ixstart = 1;
    x_speed = scanning_B.price_fixSail[760];
    b_itmp = 0;
    if (d_ixstart > 1) {
      if (rtIsNaN(scanning_B.price_fixSail[760])) {
        i = 1;
        exitg1 = false;
        while ((!exitg1) && (i + 1 <= d_ixstart)) {
          ixstart = i + 1;
          if (!rtIsNaN(scanning_B.price_fixSail[760 + i])) {
            x_speed = scanning_B.price_fixSail[760 + i];
            b_itmp = i;
            exitg1 = true;
          } else {
            i++;
          }
        }
      }

      if (ixstart < d_ixstart) {
        while (ixstart + 1 <= d_ixstart) {
          if (scanning_B.price_fixSail[760 + ixstart] < x_speed) {
            x_speed = scanning_B.price_fixSail[760 + ixstart];
            b_itmp = ixstart;
          }

          ixstart++;
        }
      }
    }

    if (1.0 > end2_idx_0) {
      d_ixstart = 0;
    } else {
      d_ixstart = (int32_T)end2_idx_0;
    }

    ixstart = 1;
    x_speed = scanning_B.price_fixSail[950];
    i = 0;
    if (d_ixstart > 1) {
      if (rtIsNaN(scanning_B.price_fixSail[950])) {
        ix = 1;
        exitg1 = false;
        while ((!exitg1) && (ix + 1 <= d_ixstart)) {
          ixstart = ix + 1;
          if (!rtIsNaN(scanning_B.price_fixSail[950 + ix])) {
            x_speed = scanning_B.price_fixSail[950 + ix];
            i = ix;
            exitg1 = true;
          } else {
            ix++;
          }
        }
      }

      if (ixstart < d_ixstart) {
        while (ixstart + 1 <= d_ixstart) {
          if (scanning_B.price_fixSail[950 + ixstart] > x_speed) {
            x_speed = scanning_B.price_fixSail[950 + ixstart];
            i = ixstart;
          }

          ixstart++;
        }
      }
    }

    // '<S2>:1:61'
    // '<S2>:1:62'
    // '<S2>:1:63'
    y_speed = std::cos(scanning_AngleDiff_f(scanning_B.price_fixSail[b_itmp],
      length_time)) * start_point_idx_0 * std::cos(scanning_AngleDiff_f
      (rtb_speed_angle_d, scanning_B.price_fixSail[b_itmp]));

    // '<S2>:1:64'
    x_speed = std::cos(scanning_AngleDiff_f(scanning_B.price_fixSail[i],
      length_time)) * start_point_idx_0 * std::cos(scanning_AngleDiff_f
      (rtb_speed_angle_d, scanning_B.price_fixSail[i]));

    // '<S2>:1:65'
    // '<S2>:1:66'
    if (scanning_B.price_fixSail[570 + b_itmp] > 1.5) {
      // '<S2>:1:67'
      // '<S2>:1:69'
      y_speed *= b_tacking_force_discount;
    }

    if (scanning_B.price_fixSail[570 + i] > 1.5) {
      // '<S2>:1:72'
      // '<S2>:1:74'
      x_speed *= b_tacking_force_discount;
    }

    // '<S2>:1:79'
    scanning_B.price[(int32_T)n - 1] = SailAngle_ground;
    if (y_speed > x_speed) {
      // '<S2>:1:80'
      // '<S2>:1:81'
      end2_idx_1 = b_itmp + 1;

      // '<S2>:1:82'
      x_speed = y_speed;
    } else {
      // '<S2>:1:84'
      end2_idx_1 = i + 1;

      // '<S2>:1:85'
    }

    // '<S2>:1:87'
    scanning_B.price[(int32_T)n + 189] = scanning_B.price_fixSail[(int32_T)
      end2_idx_1 - 1] / 3.1415926535897931 * 180.0;

    // heading
    // '<S2>:1:88'
    scanning_B.price[(int32_T)n + 379] = x_speed;

    // '<S2>:1:89'
    scanning_B.price[(int32_T)n + 569] = scanning_B.price_fixSail[(int32_T)
      end2_idx_1 + 379];

    // '<S2>:1:13'
  }

  // '<S2>:1:93'
  dead_sail_sizes[0] = 2;
  dead_sail_sizes[1] = 2;
  dead_sail_data[0] = (WindAngle_ground / 3.1415926535897931 * 180.0 - 18.0) +
    720.0;
  dead_sail_data[1] = (WindAngle_ground / 3.1415926535897931 * 180.0 + 8.0) +
    720.0;
  dead_sail_data[2] = (WindAngle_ground / 3.1415926535897931 * 180.0 - 8.0) +
    720.0;
  dead_sail_data[3] = (WindAngle_ground / 3.1415926535897931 * 180.0 + 18.0) +
    720.0;
  if (jibing > 1.5) {
    // '<S2>:1:95'
    // '<S2>:1:96'
    WindAngle_ground_0[0] = (WindAngle_ground / 3.1415926535897931 * 180.0 -
      18.0) + 720.0;
    WindAngle_ground_0[3] = (WindAngle_ground / 3.1415926535897931 * 180.0 - 8.0)
      + 720.0;
    WindAngle_ground_0[1] = (WindAngle_ground / 3.1415926535897931 * 180.0 + 8.0)
      + 720.0;
    WindAngle_ground_0[4] = (WindAngle_ground / 3.1415926535897931 * 180.0 +
      18.0) + 720.0;
    WindAngle_ground_0[2] = (sail_d_last + 90.0) + 720.0;
    WindAngle_ground_0[5] = (sail_d_last + 270.0) + 720.0;
    dead_sail_sizes[0] = 3;
    dead_sail_sizes[1] = 2;
    for (i = 0; i < 2; i++) {
      dead_sail_data[3 * i] = WindAngle_ground_0[3 * i];
      dead_sail_data[1 + 3 * i] = WindAngle_ground_0[3 * i + 1];
      dead_sail_data[2 + 3 * i] = WindAngle_ground_0[3 * i + 2];
    }
  }

  // '<S2>:1:101'
  for (ixstart = 0; ixstart < 190; ixstart++) {
    // '<S2>:1:101'
    // '<S2>:1:102'
    if (scanning_SailDeadZone(scanning_B.price[ixstart], dead_sail_data,
         dead_sail_sizes) > 0.5) {
      // '<S2>:1:103'
      // '<S2>:1:104'
      scanning_B.price[380 + ixstart] = -102.0;

      // -10002;
    }

    // '<S2>:1:101'
  }

  if (1.0 > rtb_CenterPosY) {
    d_ixstart = 0;
  } else {
    d_ixstart = (int32_T)rtb_CenterPosY;
  }

  ixstart = 1;
  x_speed = scanning_B.price[380];
  i = 0;
  if (d_ixstart > 1) {
    if (rtIsNaN(scanning_B.price[380])) {
      ix = 1;
      exitg1 = false;
      while ((!exitg1) && (ix + 1 <= d_ixstart)) {
        ixstart = ix + 1;
        if (!rtIsNaN(scanning_B.price[380 + ix])) {
          x_speed = scanning_B.price[380 + ix];
          i = ix;
          exitg1 = true;
        } else {
          ix++;
        }
      }
    }

    if (ixstart < d_ixstart) {
      while (ixstart + 1 <= d_ixstart) {
        if (scanning_B.price[380 + ixstart] > x_speed) {
          x_speed = scanning_B.price[380 + ixstart];
          i = ixstart;
        }

        ixstart++;
      }
    }
  }

  // '<S2>:1:109'
  // '<S2>:1:110'
  // '<S2>:1:111'
  // '<S2>:1:112'
  alpha_now = scanning_AngleDiff_f(scanning_B.price[i] / 180.0 *
    3.1415926535897931, heading);
  if (std::abs(scanning_B.SailForce_ground[570 + i]) < 0.17453292519943295) {
    // '<S2>:1:113'
    // '<S2>:1:114'
    if (alpha_now < 0.0) {
      x_speed = -1.0;
    } else if (alpha_now > 0.0) {
      x_speed = 1.0;
    } else if (alpha_now == 0.0) {
      x_speed = 0.0;
    } else {
      x_speed = alpha_now;
    }

    alpha_now = (std::abs(alpha_now) - 0.052359877559829883) * x_speed;
  }

  //  if abs(AngleDiff(heading,heading_d))>
  //
  //  end
  if (rtb_sail_safe < 0.5) {
    // '<S2>:1:120'
    // '<S2>:1:121'
    alpha_now = 1.5707963267948966;
  }

  x_speed = scanning_B.price[190 + i] / 180.0 * 3.1415926535897931;

  // MATLAB Function: '<Root>/MATLAB Function2' incorporates:
  //   Inport: '<Root>/ahrs_Yaw_rate'
  //   MATLAB Function: '<Root>/MATLAB Function7'
  //   UnitDelay: '<Root>/Unit Delay5'
  //   UnitDelay: '<Root>/Unit Delay6'

  // MATLAB Function 'MATLAB Function2': '<S3>:1'
  // 
  // '<S3>:1:2'
  y_speed = ((scanning_P.Ki * scanning_AngleDiff_p(Horizontal_speed_angle,
    x_speed) * scanning_P.run_period + scanning_DW.UnitDelay5_DSTATE) +
             scanning_P.Kp * scanning_AngleDiff_p(Horizontal_speed_angle,
              x_speed)) + (scanning_AngleDiff_p(scanning_DW.UnitDelay6_DSTATE,
    x_speed) / scanning_P.run_period - scanning_U.ahrs_Yaw_rate) * scanning_P.Kd;

  // '<S3>:1:5'
  // '<S3>:1:6'
  if (std::abs(y_speed) > 0.43633231299858238) {
    // '<S3>:1:7'
    // '<S3>:1:8'
    if (y_speed < 0.0) {
      y_speed = -1.0;
    } else if (y_speed > 0.0) {
      y_speed = 1.0;
    } else {
      if (y_speed == 0.0) {
        y_speed = 0.0;
      }
    }

    y_speed *= 0.43633231299858238;
  }

  // Outport: '<Root>/rudder' incorporates:
  //   MATLAB Function: '<Root>/MATLAB Function2'

  scanning_Y.rudder = y_speed;

  // Outport: '<Root>/sail' incorporates:
  //   MATLAB Function: '<Root>/MATLAB Function1'

  scanning_Y.sail = alpha_now;

  // Outport: '<Root>/wind_angle_ground'
  scanning_Y.wind_angle_ground = rtb_WindAngle_mean;

  // Outport: '<Root>/wind_speed' incorporates:
  //   MATLAB Function: '<Root>/MATLAB Function6'

  scanning_Y.wind_speed = WindSpeed_mean;

  // Outport: '<Root>/speed_angle' incorporates:
  //   MATLAB Function: '<Root>/MATLAB Function7'

  scanning_Y.speed_angle = Horizontal_speed_angle;

  // Outport: '<Root>/leg' incorporates:
  //   MATLAB Function: '<Root>/MATLAB Function'

  scanning_Y.leg = leg;

  // Outport: '<Root>/los_heading'
  scanning_Y.los_heading = rtb_speed_angle_d;

  // Outport: '<Root>/speed_angle_d'
  scanning_Y.speed_angle_d = x_speed;

  // Update for UnitDelay: '<Root>/Unit Delay15'
  memcpy(&scanning_DW.UnitDelay15_DSTATE[0], &rtb_pos_history[0], 300U * sizeof
         (real_T));

  // Update for UnitDelay: '<Root>/Unit Delay14'
  memcpy(&scanning_DW.UnitDelay14_DSTATE[0], &scanning_B.ship_speed_history[0],
         800U * sizeof(real_T));

  // Update for UnitDelay: '<Root>/Unit Delay' incorporates:
  //   MATLAB Function: '<Root>/MATLAB Function'

  scanning_DW.UnitDelay_DSTATE = leg;

  // Update for UnitDelay: '<Root>/Unit Delay4' incorporates:
  //   MATLAB Function: '<Root>/MATLAB Function3'

  scanning_DW.UnitDelay4_DSTATE = tn;

  // Update for UnitDelay: '<Root>/Unit Delay2' incorporates:
  //   MATLAB Function: '<Root>/MATLAB Function3'

  scanning_DW.UnitDelay2_DSTATE = rtb_path[0];

  // Update for UnitDelay: '<Root>/Unit Delay3' incorporates:
  //   MATLAB Function: '<Root>/MATLAB Function3'

  scanning_DW.UnitDelay3_DSTATE = rtb_path[11];

  // Update for UnitDelay: '<Root>/Unit Delay13'
  memcpy(&scanning_DW.UnitDelay13_DSTATE[0], &scanning_B.real_wind_history[0],
         6000U * sizeof(real_T));

  // Update for UnitDelay: '<Root>/Unit Delay7' incorporates:
  //   MATLAB Function: '<Root>/MATLAB Function1'

  scanning_DW.UnitDelay7_DSTATE = alpha_now;

  // Update for UnitDelay: '<Root>/Unit Delay8'
  scanning_DW.UnitDelay8_DSTATE = x_speed;

  // Update for UnitDelay: '<Root>/Unit Delay9'
  scanning_DW.UnitDelay9_DSTATE = rtb_jibing;

  // Update for UnitDelay: '<Root>/Unit Delay11' incorporates:
  //   MATLAB Function: '<Root>/MATLAB Function5'

  scanning_DW.UnitDelay11_DSTATE = loose_time;

  // Update for UnitDelay: '<Root>/Unit Delay6' incorporates:
  //   MATLAB Function: '<Root>/MATLAB Function2'

  scanning_DW.UnitDelay6_DSTATE = x_speed;

  // Update for UnitDelay: '<Root>/Unit Delay5' incorporates:
  //   MATLAB Function: '<Root>/MATLAB Function2'
  //   MATLAB Function: '<Root>/MATLAB Function7'
  //   UnitDelay: '<Root>/Unit Delay5'

  scanning_DW.UnitDelay5_DSTATE += scanning_P.Ki * scanning_AngleDiff_p
    (Horizontal_speed_angle, x_speed) * scanning_P.run_period;
}

// Model initialize function
void scanningModelClass::initialize()
{
  // Registration code

  // initialize non-finites
  rt_InitInfAndNaN(sizeof(real_T));

  // initialize error status
  rtmSetErrorStatus((&scanning_M), (NULL));

  // states (dwork)
  (void) memset((void *)&scanning_DW, 0,
                sizeof(DW_scanning_T));

  // external inputs
  (void) memset((void *)&scanning_U, 0,
                sizeof(ExtU_scanning_T));

  // external outputs
  (void) memset((void *)&scanning_Y, 0,
                sizeof(ExtY_scanning_T));

  // InitializeConditions for UnitDelay: '<Root>/Unit Delay'
  scanning_DW.UnitDelay_DSTATE = 1.0;

  // InitializeConditions for UnitDelay: '<Root>/Unit Delay4'
  scanning_DW.UnitDelay4_DSTATE = 1.0;

  // InitializeConditions for UnitDelay: '<Root>/Unit Delay1'
  scanning_DW.UnitDelay1_DSTATE = 0.1;

  // InitializeConditions for UnitDelay: '<Root>/Unit Delay8'
  scanning_DW.UnitDelay8_DSTATE = 1.5707963267948966;

  // InitializeConditions for UnitDelay: '<Root>/Unit Delay9'
  scanning_DW.UnitDelay9_DSTATE = 1.0;

  // InitializeConditions for UnitDelay: '<Root>/Unit Delay11'
  scanning_DW.UnitDelay11_DSTATE = -1.0;

  // InitializeConditions for UnitDelay: '<Root>/Unit Delay6'
  scanning_DW.UnitDelay6_DSTATE = 1.5707963267948966;
}

// Model terminate function
void scanningModelClass::terminate()
{
  // (no terminate code required)
}

// Constructor
scanningModelClass::scanningModelClass()
{
  P_scanning_T scanning_P_temp = {
    0.4,
    0.0001,
    0.3,
    5.0,
    50.0,
    50.0,
    1.0,
    3.0,
    0.1,

    { 0.0, 0.0, -160.0, -160.0, 0.0, 160.0, 0.0, 160.0 },
    40.0,
    0.8,
    10.0
  };                                   // Modifiable parameters

  // Initialize tunable parameters
  scanning_P = scanning_P_temp;
}

// Destructor
scanningModelClass::~scanningModelClass()
{
  // Currently there is no destructor body generated.
}

// Real-Time Model get method
RT_MODEL_scanning_T * scanningModelClass::getRTM()
{
  return (&scanning_M);
}

//
// File trailer for generated code.
//
// [EOF]
//
